let timer,Audioplayer;NProgress.configure({showSpinner:!1}),NProgress.configure({trickleSpeed:200}),history.scrollRestoration="manual";let editListeningSliderDebounceTimeOut,lessonQuestionCount=0,csrf_token=null,editListeningQuillArray=new Array,editListeningQuestionsArray=new Array,editListeningQuestionCount=0,safeToExit=!0;const apiSubdomain="https://api.engboost.vn/";let editReadingSliderDebouncecTimeOut,editArticleQill,editReadingQuestionCount=0,editReadingQuillArray=new Array,editReadingQuestionsArray=new Array,editReadingPassageQuillArray=new Array,editReadingPassageArray=new Array,showingCheatingAlert=!1,editFlashcardFlashcardCount=0,editFlashcardQuillArray=new Array,faceApiModelsLoaded=!1,faceApiModelLoadingPromise=null,recaptchaLoader=null;function loadRecaptchaV3(e){return recaptchaLoader||(recaptchaLoader=new Promise(((t,n)=>{if(window.grecaptcha)return void t(window.grecaptcha);if(document.getElementById("recaptcha-v3-script")){const e=setInterval((()=>{window.grecaptcha&&(clearInterval(e),t(window.grecaptcha))}),50);return}const o=document.createElement("script");o.id="recaptcha-v3-script",o.src=`https://www.google.com/recaptcha/api.js?render=${e}`,o.async=!0,o.defer=!0,o.onload=()=>t(window.grecaptcha),o.onerror=e=>{recaptchaLoader=null,n(e)},document.head.appendChild(o)})),recaptchaLoader)}function showLoginScreenWhenRecaptchaReady(e){loadRecaptchaV3(e).then((()=>{checkLoginStatus().then((e=>{if(switchPages(),e)return loadHomePage(),void window.history.pushState({},"","/");document.title="Đăng nhập",document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("login").forEach((e=>e.style.display="block")),NProgress.done()}))})).catch((e=>{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Failed to load reCAPTCHA. Please refresh."})}))}const originalFetch=window.fetch;function setDarkMode(){document.getElementById("footer").classList.remove("bg-white"),document.documentElement.classList.add("dark-mode"),document.getElementById("default-navbar").classList.add("navbar-dark"),document.querySelector("#ui-navbar-not-logged-in-loginButton").classList.remove("btn-outline-dark"),document.querySelector("#ui-navbar-not-logged-in-loginButton").classList.add("btn-outline-white"),document.querySelector("#ui-navbar-not-logged-in-registerButton").classList.remove("btn-outline-dark"),document.querySelector("#ui-navbar-not-logged-in-registerButton").classList.add("btn-outline-white"),document.querySelectorAll(".ui-login-icons").forEach((e=>{e.style.color="white"}))}function setLightMode(){document.documentElement.classList.remove("dark-mode"),document.getElementById("footer").classList.add("bg-white"),document.getElementById("default-navbar").classList.remove("navbar-dark"),document.querySelector("#ui-navbar-not-logged-in-loginButton").classList.add("btn-outline-dark"),document.querySelector("#ui-navbar-not-logged-in-loginButton").classList.remove("btn-outline-white"),document.querySelector("#ui-navbar-not-logged-in-registerButton").classList.add("btn-outline-dark"),document.querySelector("#ui-navbar-not-logged-in-registerButton").classList.remove("btn-outline-white"),document.querySelectorAll(".ui-login-icons").forEach((e=>{e.style.color="#272c33"}))}function waitForElement(e,t){const n=document.querySelector(e);n?t(n):setTimeout((()=>waitForElement(e,t)),100)}function setPointerEventsFlipcard(e,t){const n=e.querySelector(".front"),o=e.querySelector(".back");n&&o&&(t?(n.style.pointerEvents="none",o.style.pointerEvents="auto"):(n.style.pointerEvents="auto",o.style.pointerEvents="none"))}async function performSaveDraftReading(e,t){document.getElementById("ui-edit-reading-syncStatusText").textContent="Đang lưu bản nháp",document.getElementById("ui-edit-reading-syncStatusIcon").textContent="sync",safeToExit=!1;const n=new Array;for(let e=0;e<editReadingPassageQuillArray.length;e++)n.push(DOMPurify.sanitize(editReadingPassageQuillArray[e].root.innerHTML));t.append("lessonId",e),t.append("lessonPassages",JSON.stringify(n)),t.append("lessonOneTime",document.querySelector("#ui-edit-reading-oneTimeAllowCheckbox").checked),t.append("saveSettings",JSON.stringify({saveType:"draft"})),t.append("csrf_token",csrf_token),await fetch(apiSubdomain+"edit/reading/publish",{method:"POST",body:t}),safeToExit=!0,document.getElementById("ui-edit-reading-syncStatusText").textContent="Đã lưu bản nháp",document.getElementById("ui-edit-reading-syncStatusIcon").textContent="done_all"}async function loadBlogPost(e){NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("blogId",e);const n=await fetch(apiSubdomain+"blog/details",{method:"POST",body:t});if(n.ok){const e=await n.json();document.title=e.informations.name,document.getElementById("ui-blog-post-blogTitle").textContent=e.informations.name,document.querySelector("#ui-blog-post-blogContentArea").innerHTML=e.informations.content}else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("blog-post").forEach((e=>e.style.display="block")),await switchPages(),NProgress.done()}async function loadEditAccountPage(){NProgress.start(),await checkLoginStatus(),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("account").forEach((e=>e.style.display="block")),await switchPages(),NProgress.done()}async function loadNewsManagerPage(){NProgress.start(),await checkLoginStatus(),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("manage-quizzes").forEach((e=>e.style.display="block")),NProgress.done(),document.title="Quản Lý Thông Báo",document.querySelectorAll(".ui-manage-lessons-courseName").forEach((e=>e.textContent="Quản Lý Thông Báo")),document.querySelector("#ui-manage-lessons-skillList").style.display="none",document.querySelector("#ui-manage-lessons-createDropdownButton").style.display="none",await switchPages()}async function loadDictionaryDefinitionPage(e){NProgress.start(),await checkLoginStatus(),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("dictionary").forEach((e=>e.style.display="block")),NProgress.done(),document.title="Từ điển",document.querySelector("#ui-dictionary-searchWord").textContent=e.toLowerCase();const t=new FormData;t.append("query",e),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"dictionary/search",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();document.querySelector("#ui-dictionary-wordClass").textContent=o.word_class,document.getElementById("ui-dictionary-britishPhoneticsAudio").src="https://api.dictionaryapi.dev/media/pronunciations/en/"+e.toLowerCase()+"-uk.mp3",await switchPages()}async function saveChangesEditArticle(e){const t=$("#ui-edit-article-addToCourseSelect").select2("data"),n=$("#ui-edit-article-addToSectionSelect").select2("data"),o=new FormData;o.append("articleId",e),o.append("articleName",document.querySelector("#ui-edit-article-nameField").value.trim()),o.append("articleContent",editArticleQill.root.innerHTML),o.append("articleAllowComments",document.querySelector("#ui-edit-article-allowCommentCheckbox").checked),o.append("articleLocked",document.querySelector("#ui-edit-article-lockArticleCheckbox").checked),o.append("articleCourses",JSON.stringify(t.map((e=>parseInt(e.id,10))))),o.append("articleSections",JSON.stringify(n.map((e=>parseInt(e.id,10))))),o.append("csrf_token",csrf_token);const i=await fetch(apiSubdomain+"edit/article/publish",{body:o,method:"POST"});if(!i.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}if("success"===(await i.json()).message)document.querySelector("#ui-edit-article-syncStatusText").textContent="Đã lưu bản nháp";else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}}function editArticleQillTextChangeHandle(){editArticleQillTextChangeHandle.timeoutId&&clearTimeout(editArticleQillTextChangeHandle.timeoutId),document.querySelector("#ui-edit-article-syncStatusText").textContent="Đang lưu bản nháp",editArticleQillTextChangeHandle.timeoutId=setTimeout((async()=>{saveChangesEditArticle(window.location.pathname.split("/").filter(Boolean).pop())}),1e3)}async function loadEditArticlePage(e){await NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("articleId",e),t.append("action","editing"),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/article/details",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();if("success"!==o.message){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}document.title=o.informations.articleName,document.querySelectorAll(".ui-edit-article-articleName").forEach((e=>{e.textContent=o.informations.articleName})),document.querySelector("#ui-edit-article-nameField").value=o.informations.articleName,document.getElementById("ui-edit-article-addToCourseSelect").replaceChildren(),editArticleQill=await new Quill("#soan-bai-giang-field",{theme:"snow",modules:{toolbar:[["bold","italic","underline","strike","blockquote","code-block","link","image"],[{header:1},{header:2},{header:3},{header:4}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},placeholder:"Soạn nội dung câu hỏi tại đây..."});const i=o.informations.articleContent[0];editArticleQill.clipboard.dangerouslyPasteHTML(i);const a=new FormData;a.append("csrf_token",csrf_token);const r=await fetch(apiSubdomain+"edit/article/courses",{method:"POST",body:a});if(!r.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const s=await r.json();if("success"===s.message){for(x=0;x<s.courses.length;x++){const e=document.importNode(document.getElementById("ui-select2-option-element").content,!0);e.querySelector("[data-id='option']").textContent=s.courses[x].name,e.querySelector("[data-id='option']").value=s.courses[x].id,document.querySelector("#ui-edit-article-addToCourseSelect").appendChild(e)}editArticleQill.on("text-change",editArticleQillTextChangeHandle),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("edit-article").forEach((e=>e.style.display="block")),document.querySelector("#ui-edit-article-addToCourseSelect").value=o.informations.articleCourses,await switchPages(),await NProgress.done()}else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}}async function loadPrivacyPolicyPage(){NProgress.start(),await checkLoginStatus(),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("privacy-policy").forEach((e=>e.style.display="block")),switchPages(),NProgress.done()}async function performSaveDraftListening(e,t){t.append("lessonId",e),t.append("lessonOneTime",document.querySelector("#ui-edit-listening-oneTimeAllowCheckbox").checked),t.append("saveSettings",JSON.stringify({saveType:"draft"})),t.append("csrf_token",csrf_token),await fetch(apiSubdomain+"edit/listening/publish",{method:"POST",body:t}),safeToExit=!0,document.getElementById("ui-edit-listening-syncStatusText").textContent="Đã lưu bản nháp",document.getElementById("ui-edit-listening-syncStatusIcon").textContent="done_all"}async function loadEditNewsPage(e){const t=new FormData;t.append("newsId",e),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/news/details",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();document.title=o.informations.newsName}async function loadEditFlashcardPage(e){editFlashcardQuillArray=new Array,NProgress.start();const t=new FormData;t.append("flashcardId",e),t.append("csrf_token",csrf_token),editFlashcardFlashcardCount=0;const n=await fetch(apiSubdomain+"edit/flashcard/details",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}editFlashcardQuillArray.push(new Quill("#ui-edit-flashcard-front-quill",{theme:"snow",placeholder:"Soạn nội dung mặt trước tại đây..."})),editFlashcardQuillArray.push(new Quill("#ui-edit-flashcard-back-quill",{theme:"snow",placeholder:"Soạn nội dung mặt sau tại đây..."}));const o=await n.json();document.querySelectorAll(".ui-edit-flashcard-flashcardName").forEach((e=>{e.textContent=o.informations.flashcardName})),o.flashcards.forEach((e=>{editFlashcardFlashcardCount+=1;const t=document.importNode(document.getElementById("ui-edit-flashcard-flashcardElement").content,!0);t.querySelector("[data-id='flashcardElement']").id="ui-edit-flashcardElement-flashcard"+o.flashcards[editFlashcardFlashcardCount-1].id,t.querySelector("[data-id='flashcard-count']").textContent="Thẻ ghi nhớ "+editFlashcardFlashcardCount,t.querySelector("[data-id='delete-flashcard-button']").setAttribute("data-flashcard-id",o.flashcards[editFlashcardFlashcardCount-1].id),t.querySelector("[data-id='edit-flashcard-button']").setAttribute("data-flashcard-id",o.flashcards[editFlashcardFlashcardCount-1].id),t.querySelector('[data-id="js-acc-front"]').id="ui-edit-flashcard-accordion-front-"+editFlashcardFlashcardCount,t.querySelector('[data-id="course-toc-front"]').id="course-toc-front-"+editFlashcardFlashcardCount,t.querySelector('[data-id="course-acc-front"]').setAttribute("data-target","#course-toc-front-"+editFlashcardFlashcardCount),t.querySelector('[data-id="course-acc-front"]').setAttribute("data-parent","#ui-edit-flashcard-accordion-front-"+editFlashcardFlashcardCount),t.querySelector('[data-id="div-collapse-front"]').id=`collapse-front-${editFlashcardFlashcardCount}`,t.querySelector('[data-id="div-collapse-front"]').innerHTML=o.flashcards[editFlashcardFlashcardCount-1].answer[0],t.querySelector('[data-id="js-acc-back"]').id="ui-edit-flashcard-accordion-back-"+editFlashcardFlashcardCount,t.querySelector('[data-id="course-toc-back"]').id="course-toc-back-"+editFlashcardFlashcardCount,t.querySelector('[data-id="course-acc-back"]').setAttribute("data-target","#course-toc-back-"+editFlashcardFlashcardCount),t.querySelector('[data-id="course-acc-back"]').setAttribute("data-parent","#ui-edit-flashcard-accordion-back-"+editFlashcardFlashcardCount),t.querySelector('[data-id="div-collapse-back"]').id=`collapse-back-${editFlashcardFlashcardCount}`,t.querySelector('[data-id="div-collapse-back"]').innerHTML=o.flashcards[editFlashcardFlashcardCount-1].answer[1],document.querySelector("#ui-manage-flashcard-flashcardContainer").appendChild(t),document.getElementById("ui-edit-flashcard-placeholder")&&document.querySelector("#ui-edit-flashcard-placeholder").remove()})),document.getElementById("ui-edit-flashcard-flashcardNameTextField").value=o.informations.flashcardName,document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("edit-flashcard").forEach((e=>e.style.display="block")),document.getElementById("ui-edit-flashcard-oneTimeAllowCheckbox").checked=o.informations.flashcardSettings.oneTime,document.querySelector("#ui-edit-flashcard-allowComments").checked=o.informations.flashcardSettings.allowComments,document.title=o.informations.flashcardName,await switchPages(),NProgress.done()}async function performAddNewFlashcard(e){if(e.preventDefault(),e.target.blur(),"<p><br></p>"===editFlashcardQuillArray[0].root.innerHTML){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn chưa nhập nội dung mặt trước"})}if("<p><br></p>"===editFlashcardQuillArray[1].root.innerHTML){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn chưa nhập nội dung mặt sau"})}await performSaveDraftFlashcard();Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Bạn đã thêm thẻ ghi nhớ mới"}),document.querySelector("#ui-edit-flashcard-chooseAudioFrontInput").value="",document.querySelector("#ui-edit-flashcard-chooseAudioBackInput").value=""}async function performSaveDraftFlashcard(){const e=new Array,t=async t=>{const n=apiSubdomain+"edit/flashcard/upload",o=new FormData;o.append("file",t),o.append("csrf_token",csrf_token);const i=await fetch(n,{method:"POST",body:o});if(!i.ok)throw new Error("File upload failed!");const a=await i.json();e.push(a.file)};document.querySelector("#ui-edit-flashcard-chooseAudioFrontInput").files&&document.querySelector("#ui-edit-flashcard-chooseAudioFrontInput").files.length>0?await t(document.getElementById("ui-edit-flashcard-chooseAudioFrontInput").files[0]):e.push(null),document.querySelector("#ui-edit-flashcard-chooseAudioBackInput").files&&document.querySelector("#ui-edit-flashcard-chooseAudioBackInput").files.length>0?await t(document.getElementById("ui-edit-flashcard-chooseAudioBackInput").files[0]):e.push(null);const n=new FormData;n.append("lesson_id",window.location.pathname.split("/").filter(Boolean).pop());const o={saveType:"draft"};n.append("saveSettings",JSON.stringify(o));const i={front:{text:DOMPurify.sanitize(editFlashcardQuillArray[0].root.innerHTML),audio:e[0]},back:{text:DOMPurify.sanitize(editFlashcardQuillArray[1].root.innerHTML),audio:e[1]}};n.append("saveChanges",JSON.stringify(i)),n.append("csrf_token",csrf_token);const a=await fetch(apiSubdomain+"edit/flashcard/publish",{method:"POST",body:n}),r=await a.json();editFlashcardFlashcardCount+=1;const s=document.importNode(document.getElementById("ui-edit-flashcard-flashcardElement").content,!0);s.querySelector("[data-id='flashcardElement']").id="ui-edit-flashcardElement-flashcard"+r.results.insert_id,s.querySelector("[data-id='flashcard-count']").textContent="Thẻ ghi nhớ "+editFlashcardFlashcardCount,s.querySelector("[data-id='delete-flashcard-button']").setAttribute("data-flashcard-id",r.results.insert_id),s.querySelector("[data-id='edit-flashcard-button']").setAttribute("data-flashcard-id",r.results.insert_id),s.querySelector('[data-id="js-acc-front"]').id="ui-edit-flashcard-accordion-front-"+editFlashcardFlashcardCount,s.querySelector('[data-id="course-toc-front"]').id="course-toc-front-"+editFlashcardFlashcardCount,s.querySelector('[data-id="course-acc-front"]').setAttribute("data-target","#course-toc-front-"+editFlashcardFlashcardCount),s.querySelector('[data-id="course-acc-front"]').setAttribute("data-parent","#ui-edit-flashcard-accordion-front-"+editFlashcardFlashcardCount),s.querySelector('[data-id="div-collapse-front"]').id=`collapse-front-${editFlashcardFlashcardCount}`,s.querySelector('[data-id="div-collapse-front"]').innerHTML=r.results.front,s.querySelector('[data-id="js-acc-back"]').id="ui-edit-flashcard-accordion-back-"+editFlashcardFlashcardCount,s.querySelector('[data-id="course-toc-back"]').id="course-toc-back-"+editFlashcardFlashcardCount,s.querySelector('[data-id="course-acc-back"]').setAttribute("data-target","#course-toc-back-"+editFlashcardFlashcardCount),s.querySelector('[data-id="course-acc-back"]').setAttribute("data-parent","#ui-edit-flashcard-accordion-back-"+editFlashcardFlashcardCount),s.querySelector('[data-id="div-collapse-back"]').id=`collapse-back-${editFlashcardFlashcardCount}`,s.querySelector('[data-id="div-collapse-back"]').innerHTML=r.results.back,document.getElementById("ui-manage-flashcard-flashcardContainer").appendChild(s),editFlashcardQuillArray[0].clipboard.dangerouslyPasteHTML("<p><br></p>"),editFlashcardQuillArray[1].clipboard.dangerouslyPasteHTML("<p><br></p>")}async function loadEditReadingPage(e){$("#ui-edit-reading-timeLimitSlider").ionRangeSlider({min:1,max:60,from:0,grid:!0,postfix:" phút",disable:!0,type:"single",onFinish:async function(){clearInterval(editListeningSliderDebounceTimeOut),editListeningSliderDebounceTimeOut=setTimeout((async()=>{await checkLoginStatus();const e=new FormData;e.append("saveChanges","{}"),e.append("lessonTime",parseInt(document.getElementById("ui-edit-listening-timeLimitSlider").value)),await performSaveDraftReading(window.location.pathname.split("/").filter(Boolean).pop(),e)}),1e3)}});editReadingQuestionCount=0,editReadingQuestionsArray=new Array,editReadingQuillArray=new Array,NProgress.start();const t=new FormData;t.append("lessonId",e),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/reading/details",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();document.getElementById("ui-edit-reading-questionContainerRoot").replaceChildren();for(let e=0;e<o.informations.lessonParts;e++){const t=document.importNode(document.getElementById("edit-reading-passageEditor").content,!0);t.querySelector('[data-id="passage-editor-field"]').id="edit-reading-passage-quill-part"+[e+1],t.querySelector('[data-id="passage-editor-title"]').textContent="Soạn bài đọc phần "+[e+1],document.querySelector("#ui-edit-reading-questionContainerRoot").appendChild(t),editReadingPassageQuillArray.push(new Quill("#edit-reading-passage-quill-part"+[e+1],{theme:"snow",placeholder:"Soạn nội dung bài đọc tại đây..."}));const n=document.createElement("div");n.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent="Câu hỏi phần "+[e+1],n.appendChild(i),document.querySelector("#ui-edit-reading-questionContainerRoot").appendChild(n);const a=document.createElement("div");if(a.id="ui-edit-reading-questionsContainerPart"+[e+1],document.querySelector("#ui-edit-reading-questionContainerRoot").appendChild(a),0===o.questions.length){const t=document.createElement("div"),n=document.createElement("h5"),o=document.createElement("center");o.id="placeholder_reading_part"+[e+1],o.style.marginBottom="40px",t.style.backgroundImage='url("https://bunny.net/bn-cookies/Bunny%20Cookies.svg")',t.style.backgroundRepeat="no-repeat",t.style.height="200px",t.style.width="169px",t.style.backgroundSize="contain",n.textContent="Bạn chưa thêm câu hỏi nào",o.appendChild(t),o.appendChild(document.createElement("br")),o.appendChild(n),document.querySelector("#ui-edit-reading-questionContainerRoot").appendChild(o)}else{const t=document.createElement("div");t.id="ui-create-readingContainer-Part"+[e+1],document.getElementById("ui-edit-reading-questionContainerRoot").appendChild(t);const n=document.importNode(document.querySelector("#ui-edit-lesson-questionCard").content,!0);n.querySelector('[data-id="question-count"]').textContent="Câu hỏi ",document.querySelector("#ui-create-readingContainer-Part"+[e+1]).appendChild(n),editReadingQuestionCount+=1}const r=document.importNode(document.querySelector("#ui-edit-lesson-questionEditor").content,!0);r.querySelector('[data-id="question-description-field"]').id="ui-edit-reading-questionDescriptionFieldPart"+[e+1],r.querySelector('[data-id="question-category-selector"]').id=`ui-edit-reading-questionCategorySelectorPart${[e+1]}`,r.querySelector('[data-id="multiple-choice-editor"]').id=`ui-edit-reading-multipleChoiceEditorPart${[e+1]}`,r.querySelector('[data-id="multiple-choice-answer-container"]').id=`ui-edit-reading-multipleChoiceAnswerContainerPart${[e+1]}`,r.querySelector('[data-id="multiple-choice-answer-input"]').classList.add("ui-edit-reading-multipleChoiceAnswerPart"+[e+1]),r.querySelector('[data-id="multiple-choice-answer-input"]').classList.add("form-control"),r.querySelector('[data-id="correct-answer-select"]').id=`ui-edit-reading-correctAnswerSelectPart${[e+1]}`,r.querySelector('[data-id="short-answer-editor"]').id=`ui-edit-reading-shortAnswerEditorPart${[e+1]}`,r.querySelector('[data-id="short-answer-container"]').id=`ui-edit-reading-shortAnswerContainerPart${[e+1]}`,r.querySelector('[data-id="short-answer-container"]').classList.add("ui-edit-reading-shortAnswerPart"+[e+1]),r.querySelector('[data-id="short-answer-input"]').classList.add("ui-edit-reading-shortAnswerAnswerPart"+[e+1]),r.querySelector('[data-id="short-answer-input"]').classList.add("form-control"),r.querySelector('[data-id="add-new-question"]').classList.add("ui-edit-reading-addNewQuestionPart"+[e+1]),r.querySelector('[data-id="add-new-part"]').classList.add("ui-edit-reading-addNewPartAfterPart"+[e+1]),r.querySelector('[data-id="delete-current-part"]').classList.add("ui-edit-reading-deleteCurrentPart"+[e+1]),r.querySelector('[data-id="delete-current-part"]').textContent="Xóa phần "+[e+1],document.getElementById("ui-edit-reading-questionContainerRoot").append(r),editReadingQuillArray.push(new Quill("#ui-edit-reading-questionDescriptionFieldPart"+[e+1],{theme:"snow",placeholder:"Soạn nội dung câu hỏi tại đây..."}))}document.querySelectorAll(".ui-edit-reading-lessonName").forEach((e=>e.textContent=o.informations.lessonName)),document.querySelectorAll(".ui-edit-reading-lessonName").forEach((t=>t.href="/edit/"+e)),document.title=o.informations.lessonName,document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("edit-reading").forEach((e=>e.style.display="block")),await switchPages(),NProgress.done()}async function loadEditListeningPage(e){function t(){const e=new FormData;e.append("saveChanges",JSON.stringify({})),$("#ui-edit-listening-noLimitTimeCheckbox").is(":checked")?e.append("lessonTime",0):e.append("lessonTime",document.getElementById("ui-edit-listening-timeLimitSlider").value),document.getElementById("ui-edit-listening-syncStatusText").textContent="Đang lưu bản nháp",document.getElementById("ui-edit-listening-syncStatusIcon").textContent="sync",performSaveDraftListening(window.location.pathname.split("/").filter(Boolean).pop(),e),a()}editListeningQuestionCount=0,editListeningQuestionsArray=new Array,editListeningQuillArray=new Array,$("#ui-edit-listening-noLimitTimeCheckbox").off("change",t),NProgress.start();const n=new FormData;n.append("lessonId",e),n.append("csrf_token",csrf_token);const o=await fetch(apiSubdomain+"edit/listening/details",{method:"POST",body:n});if(!o.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const i=$("#ui-edit-listening-timeLimitSlider").ionRangeSlider({min:1,max:60,from:0,grid:!0,postfix:" phút",disable:!0,type:"single",onFinish:async function(){document.getElementById("ui-edit-listening-syncStatusText").textContent="Đang lưu bản nháp",document.getElementById("ui-edit-listening-syncStatusIcon").textContent="sync",clearInterval(editListeningSliderDebounceTimeOut),editListeningSliderDebounceTimeOut=setTimeout((async()=>{await checkLoginStatus();const e=new FormData;e.append("saveChanges","{}"),e.append("lessonTime",parseInt(document.getElementById("ui-edit-listening-timeLimitSlider").value)),await performSaveDraftListening(window.location.pathname.split("/").filter(Boolean).pop(),e)}),1e3)}}).data("ionRangeSlider");function a(){$("#ui-edit-listening-noLimitTimeCheckbox").is(":checked")?i.update({disable:!0}):i.update({disable:!1})}a(),$("#ui-edit-listening-noLimitTimeCheckbox").on("change",t);const r=await o.json();document.title=r.informations.lessonName,document.querySelector("#ui-edit-listening-lessonNameTextField").value=r.informations.lessonName,r.informations.lessonSettings.timeLimit>0?(i.update({from:r.informations.lessonSettings.timeLimit}),document.getElementById("ui-edit-listening-noLimitTimeCheckbox").checked=!1,t()):(document.getElementById("ui-edit-listening-noLimitTimeCheckbox").checked=!0,i.update({from:1}),t()),document.getElementById("ui-edit-listening-questionContainerRoot").innerHTML="";for(let e=0;e<r.courses.length;e++){const t={id:r.courses[e].id,text:r.courses[e].name},n=new Option(t.text,t.id,!1,!1);$("#ui-edit-listening-chooseCourseSelect").append(n).trigger("change")}document.querySelector("#ui-edit-listening-chooseCourseSelect").value=r.informations.lessonCourses;for(let e=0;e<r.sections.length;e++){const t={id:r.sections[e].id,text:r.sections[e].name},n=new Option(t.text,t.id,!1,!1);$("#ui-edit-listening-chooseSectionSelect").append(n).trigger("change")}null!==r.informations.lessonSections&&(document.querySelector("#ui-edit-listening-chooseSectionSelect").value=r.informations.lessonSections);for(let t=0;t<r.informations.lessonParts;t++){document.querySelector("#ui-edit-listening-questionContainerRoot").insertAdjacentHTML("beforeend",`<div class="page-separator"><div class="page-separator__text">Câu hỏi phần ${[t+1]}</div></div><ul class="mb-40pt" style="padding: 0" id="ui-manage-lessons-questionsContainerPart${[t+1]}"></ul>`),r.questions.length>0?r.questions.forEach(((n,o)=>{if(0===n.type){const i=Array.from({length:26},((e,t)=>String.fromCharCode(65+t)));let a="";n.options=JSON.parse(n.options);for(let e=0;e<n.options.length;e++)a+=`${i[e]}. ${n.options[e]}<br>`;const r={id:o+1,question:n.question,part:n.part,type:n.type,lesson_id:e,answer:n.answer,options:n.options};let s="";editListeningQuestionsArray.push(r),JSON.parse(n.answer).forEach((e=>{const t=e-1,o=String.fromCharCode(65+t);s+=o+". "+n.options[t]}));const l=document.importNode(document.getElementById("ui-edit-lesson-questionCard").content,!0);l.querySelector('[data-id="question-count"]').textContent="Câu hỏi "+[o+1],l.querySelector('[data-id="question-content"]').innerHTML=n.question+a,l.querySelector('[data-id="div-collapse"]').id=`collapse${o+1}`,l.querySelector('[data-id="div-collapse"]').innerHTML=s,l.querySelector('[data-id="course-toc"]').id="course-toc-"+[o+1],l.querySelector('[data-id="course-acc"]').setAttribute("data-target","#course-toc-"+[o+1]),l.querySelector('[data-id="course-acc"]').setAttribute("data-parent","#ui-edit-listening-accordion-"+[o+1]),l.querySelector('[data-id="js-acc"]').id="ui-edit-listening-accordion-"+[o+1],document.querySelector("#ui-manage-lessons-questionsContainerPart"+[t+1]).appendChild(l)}else if(2===n.type){let i="";n.answer=JSON.parse(n.answer);for(let e=0;e<n.answer.length-1;e++)i+=n.answer[e]+"<br>";const a={id:o+1,question:n.question,part:n.part,type:n.type,lesson_id:e,answer:n.answer,options:null};editListeningQuestionsArray.push(a);const r=document.importNode(document.getElementById("ui-edit-lesson-questionCard").content,!0);r.querySelector('[data-id="question-count"]').textContent="Câu hỏi "+[o+1],r.querySelector('[data-id="question-content"]').innerHTML="<div class='nopadding'>"+n.question+"</div>",r.querySelector('[data-id="div-collapse"]').id=`collapse${o}`,r.querySelector('[data-id="div-collapse"]').innerHTML=i,document.querySelector("#ui-manage-lessons-questionsContainerPart"+[t+1]).appendChild(r)}editListeningQuestionCount+=1})):document.querySelector("#ui-manage-lessons-questionsContainerPart"+[t+1]).innerHTML="<center><div style='background-image: url(\"https://bunny.net/bn-cookies/Bunny%20Cookies.svg\"); background-repeat: no-repeat; height: 200px; width: 169px; background-size: contain'></div><br><h5>Bạn chưa thêm câu hỏi nào</h5></center>";const n=document.importNode(document.getElementById("ui-edit-lesson-questionEditor").content,!0);n.querySelector('[data-id="question-description-field"]').id=`ui-edit-listening-questionDescriptionFieldPart${[t+1]}`,n.querySelector('[data-id="question-category-selector"]').id=`ui-edit-listening-questionCategorySelectorPart${[t+1]}`,n.querySelector('[data-id="multiple-choice-editor"]').id=`ui-edit-listening-multipleChoiceEditorPart${[t+1]}`,n.querySelector('[data-id="multiple-choice-answer-container"]').id=`ui-edit-listening-multipleChoiceAnswerContainerPart${[t+1]}`,n.querySelector('[data-id="multiple-choice-answer-input"]').classList.add("ui-edit-listening-multipleChoiceAnswerPart"+[t+1]),n.querySelector('[data-id="multiple-choice-answer-input"]').classList.add("form-control"),n.querySelector('[data-id="correct-answer-select"]').id=`ui-edit-listening-correctAnswerSelectPart${[t+1]}`,n.querySelector('[data-id="short-answer-editor"]').id=`ui-edit-listening-shortAnswerEditorPart${[t+1]}`,n.querySelector('[data-id="short-answer-container"]').id=`ui-edit-listening-shortAnswerContainerPart${[t+1]}`,n.querySelector('[data-id="short-answer-container"]').classList.add("ui-edit-listening-shortAnswerPart"+[t+1]),n.querySelector('[data-id="short-answer-input"]').classList.add("ui-edit-listening-shortAnswerAnswerPart"+[t+1]),n.querySelector('[data-id="short-answer-input"]').classList.add("form-control"),n.querySelector('[data-id="add-new-question"]').classList.add("ui-edit-listening-addNewQuestionPart"+[t+1]),n.querySelector('[data-id="add-new-part"]').classList.add("ui-edit-listening-addNewPartAfterPart"+[t+1]),n.querySelector('[data-id="delete-current-part"]').classList.add("ui-edit-listening-deleteCurrentPart"+[t+1]),n.querySelector('[data-id="delete-current-part"]').textContent="Xóa phần "+[t+1],document.querySelector("#ui-edit-listening-questionContainerRoot").appendChild(n),editListeningQuillArray.push(new Quill("#ui-edit-listening-questionDescriptionFieldPart"+[t+1],{theme:"snow",placeholder:"Soạn nội dung câu hỏi tại đây..."}))}if(null!==r.informations.lessonAudios)for(let e=0;e<JSON.parse(r.informations.lessonAudios).length;e++)document.querySelector("#ui-edit-listening-choosenAudioFilePart"+[e+1]).textContent=JSON.parse(r.informations.lessonAudios)[0].split("/").pop();document.getElementById("ui-edit-listening-lessonName").textContent=r.informations.lessonName,document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("edit-listening").forEach((e=>e.style.display="block")),await switchPages(),NProgress.done()}async function performDeleteQuestion(e){NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("actionDelete",!0),t.append("saveSettings",JSON.stringify({saveType:"draft"})),t.append("saveChanges",JSON.stringify({})),t.append("questionId",e),t.append("lessonId",window.location.pathname.split("/").filter(Boolean).pop()),t.append("csrf_token",csrf_token),await fetch(apiSubdomain+"edit/listening/publish",{body:t,method:"POST"}),NProgress.done()}async function performLogout(){await checkLoginStatus();const e=new FormData;e.append("csrf_token",csrf_token);if((await fetch(apiSubdomain+"auth/logout",{method:"POST",body:e})).ok){loadLoginPage(),window.history.pushState({},"","/login");Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Đăng xuất thành công"}),csrf_token=null}}function startSmoothTimer(e){let t=document.querySelector(".ui-lesson-details-timer"),n=document.querySelector("#ui-lesson-details-timertext");if(!t||!n)return console.error("Timer bar or text element not found!");let o=Date.now()+e+1e3;t.style.transition=`width ${e}ms linear`,t.style.width="0%",timer=setInterval((()=>{let e=Math.max(0,o-Date.now()),t=String(Math.floor(e/6e4)).padStart(2,"0"),i=String(Math.floor(e%6e4/1e3)).padStart(2,"0");n.textContent=`Thời gian còn lại: ${t}:${i}`,e<=0&&stopTimer()}),1e3)}async function submitLessonAction(e,t){e.disabled=!0,e.classList.add("is-loading"),await checkLoginStatus();const n=new Array,o=new FormData;o.append("lesson_id",t),o.append("csrf_token",csrf_token);for(let e=1;e<=lessonQuestionCount;e++){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let o=!1;for(let i=0;i<t.length;i++){const a=`ui-lesson-details-question${e}-option${t[i]}`,r=document.getElementById(a);if(r&&"check"===r.textContent){n.push(i+1),o=!0;break}}o||n.push(0)}o.append("userAnswer",JSON.stringify(n));const i=await fetch(apiSubdomain+"lessons/scoring",{method:"POST",body:o});if(!i.ok)return void alert("Something went wrong...");const a=await i.json();if(!a.success)return void alert("Something went wrong...");a.answerState.forEach(((e,t)=>{!0===e?(document.getElementById("ui-lesson-details-question"+(t+1)).insertAdjacentHTML("beforebegin",'<i class="material-icons" style="margin-right: 1rem" id="ui-lesson-details-answerStatus'+(t+1)+'">check</i>'),document.getElementById("ui-lesson-details-question"+(t+1)).style.color="rgb(30,142,62)",document.getElementById("ui-lesson-details-answerStatus"+(t+1)).style.color="rgb(30,142,62)"):(document.getElementById("ui-lesson-details-question"+(t+1)).insertAdjacentHTML("beforebegin",'<i class="material-icons" style="margin-right: 1rem" id="ui-lesson-details-answerStatus'+(t+1)+'">close</i>'),document.getElementById("ui-lesson-details-question"+(t+1)).style.color="rgb(217,48,37)",document.getElementById("ui-lesson-details-answerStatus"+(t+1)).style.color="rgb(217,48,37)")})),clearInterval(timer),document.querySelector(".ui-lesson-details-timer").style.transition="none";Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Bài làm của bạn đã được ghi nhận"}),window.scrollTo({top:0,behavior:"smooth"});const r=new Date,s=`${String(r.getDate()).padStart(2,"0")} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.getMonth()]} ${r.getFullYear()}`;document.getElementById("ui-lesson-details-timertext").textContent="Bạn làm đúng "+a.score+"/"+a.answerState.length+" câu",document.querySelector("#ui-lesson-details-submitedOn").textContent="Đã nộp bài vào "+s,document.querySelector("#ui-lesson-details-submitedOn").style.display="block",e.classList.remove("is-loading"),document.querySelector("#ui-lesson-details-restartQuiz").style.display="inline-flex",document.querySelector("#ui-lesson-details-restartQuiz").href="/lesson/"+t;const l=new FormData;l.append("csrf_token",csrf_token),l.append("lessonId",t),l.append("userAnswer",JSON.stringify(n)),l.append("answerState",JSON.stringify(a.answerState)),l.append("correctAnswer",JSON.stringify(a.answers));await fetch(apiSubdomain+"history/record",{method:"POST",body:l})}async function addToFavourite(e,t){if(e)if("favorite_border"===e.textContent){e.textContent="favorite";const n=new FormData;n.append("item_id",t);const o=await fetch(apiSubdomain+"favorites/favorite",{method:"POST",body:n});if(!o.ok)return void alert("Something went wrong...");if(!(await o.json()).success)return void alert("Something went wrong...")}else{e.textContent="favorite_border";const n=new FormData;n.append("item_id",t);const o=await fetch(apiSubdomain+"favorites/unfavorite",{method:"POST",body:n});if(!o.ok)return void alert("Something went wrong...");if(!(await o.json()).success)return void alert("Something went wrong...")}else console.error("Element is undefined!")}window.fetch=async function(e,t){t=t||{};return("string"==typeof e?e:e.url).startsWith("https://api.engboost.vn")&&(t.credentials="include"),originalFetch(e,t)},window.addEventListener("beforeunload",(function(e){safeToExit||e.preventDefault()})),document.body.addEventListener("click",(e=>{const t=e.target.closest("a.load");if(!t)return;e.preventDefault();const n=t.getAttribute("href");if(window.history.pushState({},"",n),NProgress.start(),n.includes("login"))loadLoginPage();else if("/"===n)loadHomePage();else if(n.includes("logout"))performLogout();else if(n.includes("dashboard"))loadDashboard(n.split("/").filter(Boolean).pop());else if(n.includes("lesson"))loadLesson(n.split("/").filter(Boolean).pop());else if(n.includes("register"))loadRegisterPage();else if(n.includes("/edit/")){!async function(){await checkLoginStatus();const e=new FormData;e.append("lessonId",n.split("/").filter(Boolean).pop()),e.append("csrf_token",csrf_token);const t=await fetch(apiSubdomain+"edit/type",{method:"POST",body:e});if(t.ok){const e=await t.json();0==e.skill?loadEditListeningPage(n.split("/").filter(Boolean).pop()):2==e.skill?loadEditReadingPage(n.split("/").filter(Boolean).pop()):6==e.skill&&loadEditFlashcardPage(n.split("/").filter(Boolean).pop())}}()}else n.includes("/quizzes/")?loadManageLessonsPage(n.split("/").filter(Boolean).pop()):n.includes("privacy-policy")?loadPrivacyPolicyPage():n.includes("account")?loadEditAccountPage():n.includes("/blog/")&&"blog"!=n.split("/").filter(Boolean).pop()&&loadBlogPost(n.split("/").filter(Boolean).pop())})),addEventListener("popstate",(()=>{const e=window.location.pathname.split("/").filter(Boolean).pop()||"";if(""===e||"/"===e)loadHomePage();else if("login"===e)loadLoginPage();else if("register"===e)loadRegisterPage();else if(window.location.pathname.includes("/dashboard/"))loadDashboard(e);else if(window.location.pathname.includes("/lesson/"))loadLesson(e);else if(window.location.pathname.includes("/edit/")){!async function(){await checkLoginStatus();const t=new FormData;t.append("lessonId",e),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/type",{method:"POST",body:t});if(n.ok){const t=await n.json();0==t.skill?loadEditListeningPage(e):2==t.skill?loadEditReadingPage(e):6==t.skill&&loadEditFlashcardPage(e)}}()}else window.location.pathname.includes("/quizzes/")?loadManageLessonsPage(e):window.location.pathname.includes("privacy-policy")?loadPrivacyPolicyPage():window.location.pathname.includes("account")?loadEditAccountPage():window.location.pathname.includes("/blog/")&&"blog"!=e&&loadBlogPost(e)})),window.addEventListener("load",(()=>{const e=window.location.pathname.split("/").filter(Boolean).pop()||"";if(""===e||"/"===e)loadHomePage();else if("login"===e)loadLoginPage();else if("register"===e)loadRegisterPage();else if("logout"===e)performLogout();else if(window.location.pathname.includes("/dashboard/"))loadDashboard(e);else if(window.location.pathname.includes("/lesson/"))loadLesson(e);else if(window.location.pathname.includes("/edit/")){!async function(){await checkLoginStatus();const t=new FormData;t.append("lessonId",e),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/type",{method:"POST",body:t});if(n.ok){const t=await n.json();0==t.skill?loadEditListeningPage(e):5==t.skill?loadEditArticlePage(e):2==t.skill?loadEditReadingPage(e):6==t.skill&&loadEditFlashcardPage(e)}}()}else window.location.pathname.includes("/quizzes/")?loadManageLessonsPage(e):window.location.pathname.includes("privacy-policy")?loadPrivacyPolicyPage():window.location.pathname.includes("account")?loadEditAccountPage():window.location.pathname.includes("/blog/")&&"blog"!==e?loadBlogPost(e):window.location.pathname.includes("news/manage")?loadNewsManagerPage():window.location.pathname.includes("/dictionary/")&&loadDictionaryDefinitionPage(e)})),waitForElement(".sweetAlertInput",(function(e){e.maxLength=29,e.addEventListener("input",(function(e){let t=e.target.value.replace(/-/g,"").slice(0,25),n="";for(let e=0;e<t.length;e++)n+=t[e],(e+1)%5==0&&e<t.length-1&&(n+="-");e.target.value=n}))})),document.addEventListener("change",(function(e){if("SELECT"===e.target.tagName&&e.target.id.startsWith("ui-edit-listening-questionCategorySelectorPart")){const t=e.target.id.replace(/[^0-9]/g,"");document.getElementById("ui-edit-listening-multipleChoiceEditorPart"+t).style.display="none",document.querySelector("#ui-edit-listening-shortAnswerEditorPart"+t).style.display="none",2==e.target.value?document.querySelector("#ui-edit-listening-shortAnswerEditorPart"+t).style.display="block":0==e.target.value&&(document.getElementById("ui-edit-listening-multipleChoiceEditorPart"+t).style.display="block")}})),document.addEventListener("click",(async e=>{if(e.target&&e.target.classList.contains("ui-edit-listening-deleteMultipleChoiceAnswer")){e.preventDefault();const t=e.target.parentNode;t.parentNode.removeChild(t)}else if(e.target&&e.target.classList.contains("ui-edit-listening-addNewPartAfterPart1"))e.preventDefault(),Swal.fire({title:"Bạn chắc chắn chứ?",text:"Bạn có chắn chắn muốn thêm phần mới? Hành động này không thể hoàn tác được.",icon:"question",showCancelButton:!0,confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Có, tôi chắc chắn",cancelButtonText:"Không, hủy bỏ",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}}).then((e=>{e.isConfirmed&&Swal.fire({title:"Đã thêm phần mới!",confirmButtonColor:"#5567ff",confirmButtonText:"Đóng",text:"Bạn đã thêm phần mới vào bài tập này.",icon:"success",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}})}));else if(e.target&&e.target.classList.contains("ui-dropdown-activateCourseButton"))e.preventDefault(),Swal.fire({title:"Kích hoạt khóa học",text:"Bạn được cấp mã kích hoạt cho một khóa học tại EngBoost Academy? Hãy nhập vào ô bên dưới để tiến hành kích hoạt ngay",input:"text",icon:"info",confirmButtonColor:"#5567ff",showCancelButton:!0,confirmButtonText:"Kích hoạt ngay",cancelButtonText:"Đóng",showLoaderOnConfirm:!0,inputPlaceholder:"Nhập mã kích hoạt tại đây...",customClass:{input:"sweetAlertInput form-control",confirmButton:"swalConformButton",htmlContainer:"margin_bottom_1rem",cancelButton:"swalCancelButton"},preConfirm:async e=>{const t=new FormData;t.append("activationCode",e),t.append("csrf_token",csrf_token);try{const e="/apis/course/activate",n=await fetch(e,{method:"POST",body:t});if(!n.ok)return Swal.showValidationMessage("Lỗi hệ thống");{const e=await n.json();if("failed"===e.message)return Swal.showValidationMessage(e.reason)}}catch(e){Swal.showValidationMessage(`Request failed: ${e}`)}},allowOutsideClick:()=>!Swal.isLoading()}).then((e=>{e.isConfirmed&&Swal.fire({title:"Đã kích hoạt thành công!",confirmButtonColor:"#5567ff",confirmButtonText:"Đóng",text:"Cảm ơn bạn đã tin tưởng học tập tại EngBoost Academy. Chúc bạn có một ngày thật vui vẻ.",icon:"success",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}})}));else if(e.target&&e.target.classList.contains("ui-edit-listening-deleteLessonButton"))e.preventDefault(),Swal.fire({title:"Bạn chắc chắn chứ?",text:"Bạn có chắn chắn muốn xóa bài tập này? Hành động này không thể hoàn tác được.",icon:"question",showCancelButton:!0,confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Có, tôi chắc chắn",cancelButtonText:"Không, đừng xóa",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}}).then((e=>{e.isConfirmed&&Swal.fire({title:"Đã xóa bài tập!",confirmButtonColor:"#5567ff",confirmButtonText:"Đã hiểu",text:"Bài tập này đã được xóa khỏi hệ thống.",icon:"success",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}})}));else if(e.target&&e.target.className.startsWith("btn btn-outline-primary ui-edit-listening-addNewQuestionPart")){e.preventDefault();const t=e.target.className.match(/\d+/)[0];if("<p><br></p>"==editListeningQuillArray[t-1].container.firstChild.innerHTML.trim()){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn chưa nhập nội dung câu hỏi"})}if(0==document.querySelector("#ui-edit-listening-questionCategorySelectorPart"+t).value){if([...document.querySelectorAll(".ui-edit-listening-multipleChoiceAnswerPart"+t)].some((e=>""===e.value))){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn có một câu trả lời trống"})}e.target.disabled=!0,e.target.classList.add("is-loading"),NProgress.start(),await checkLoginStatus();const n=new Array;document.querySelectorAll('input[class^="ui-edit-listening-multipleChoiceAnswerPart'+t+'"]').forEach((e=>{n.push(e.value)}));const o=new Array;o.push(parseInt(document.getElementById("ui-edit-listening-correctAnswerSelectPart"+t).value));const i={id:editListeningQuestionCount+=1,question:editListeningQuillArray[t-1].root.innerHTML.trim(),part:t,type:document.getElementById("ui-edit-listening-questionCategorySelectorPart"+t).value,lesson_id:window.location.pathname.split("/").filter(Boolean).pop(),answer:o,options:n};editListeningQuestionsArray.push(i);let a="";const r=Array.from({length:26},((e,t)=>String.fromCharCode(65+t)));for(let e=1;e<=n.length;e++)a+=r[e-1]+". "+n[e-1]+"<br>";const s=document.importNode(document.getElementById("ui-edit-lesson-questionCard").content,!0);s.querySelector('[data-id="question-count"]').textContent="Câu hỏi "+editListeningQuestionCount,s.querySelector('[data-id="question-content"]').innerHTML=editListeningQuillArray[t-1].root.innerHTML+a,s.querySelector('[data-id="div-collapse"]').id=`collapse${editListeningQuestionCount}`,s.querySelector('[data-id="div-collapse"]').innerHTML=n[parseInt(o[0])-1],s.querySelector('[data-id="course-toc"]').id="course-toc-"+editListeningQuestionCount,s.querySelector('[data-id="course-acc"]').setAttribute("data-target","#course-toc-"+editListeningQuestionCount),s.querySelector('[data-id="course-acc"]').setAttribute("data-parent","#ui-edit-listening-accordion-"+editListeningQuestionCount),s.querySelector('[data-id="js-acc"]').id="ui-edit-listening-accordion-"+editListeningQuestionCount,document.querySelector("#ui-manage-lessons-questionsContainerPart"+t).appendChild(s),editListeningQuillArray[t-1].setText("");let l=document.getElementById(`ui-edit-listening-multipleChoiceAnswerContainerPart${t}`)?.firstElementChild?.nextElementSibling;for(;l;){const e=l.nextElementSibling;l.parentNode.removeChild(l),l=e}const c=new FormData;c.append("saveChanges",JSON.stringify(i)),await performSaveDraftListening(window.location.pathname.split("/").filter(Boolean).pop(),c),NProgress.done(),e.target.disabled=!1,e.target.classList.remove("is-loading"),document.querySelector("#ui-edit-listening-correctAnswerSelectPart"+t).querySelectorAll("option").forEach((e=>{"A"!==e.textContent&&document.getElementById("ui-edit-listening-correctAnswerSelectPart"+t).removeChild(e)})),document.querySelectorAll('input[class^="ui-edit-listening-multipleChoiceAnswerPart'+t+'"]').forEach((e=>{e.value=""}));Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Bạn đã thêm câu hỏi mới"})}else if(2==document.querySelector("#ui-edit-listening-questionCategorySelectorPart"+t).value){if([...document.querySelectorAll(".ui-edit-listening-shortAnswerAnswerPart"+t)].some((e=>""===e.value))){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn có một câu trả lời trống"})}e.target.disabled=!0,e.target.classList.add("is-loading"),NProgress.start(),await checkLoginStatus();const n=new Array;if(document.querySelectorAll('input[class^="ui-edit-listening-shortAnswerAnswerPart'+t+'"]').forEach((e=>{n.push(e.value)})),document.querySelector("#ui-edit-listening-ignoreCaseSensitive").checked){const e={caseSensitive:!1};n.push(e)}else{const e={caseSensitive:!0};n.push(e)}const o={id:editListeningQuestionCount+=1,question:editListeningQuillArray[t-1].container.firstChild.innerHTML.trim(),part:t,type:document.getElementById("ui-edit-listening-questionCategorySelectorPart"+t).value,lesson_id:window.location.pathname.split("/").filter(Boolean).pop(),answer:n,options:null};editListeningQuestionsArray.push(o);let i="";for(let e=1;e<n.length;e++)i+=n[e-1]+"<br>";const a=document.importNode(document.getElementById("ui-edit-lesson-questionCard").content,!0);a.querySelector('[data-id="question-count"]').textContent="Câu hỏi "+editListeningQuestionCount,a.querySelector('[data-id="question-content"]').innerHTML="<div class='nopadding'>"+editListeningQuillArray[t-1].container.firstChild.innerHTML.trim()+"</div>",a.querySelector('[data-id="div-collapse"]').id=`collapse${editListeningQuestionCount}`,a.querySelector('[data-id="div-collapse"]').innerHTML=i,document.querySelector("#ui-manage-lessons-questionsContainerPart"+t).appendChild(a),editListeningQuillArray[t-1].setText("");let r=document.getElementById(`ui-edit-listening-shortAnswerContainerPart${t}`)?.firstElementChild?.nextElementSibling;for(;r;){const e=r.nextElementSibling;r.parentNode.removeChild(r),r=e}const s=new FormData;s.append("saveChanges",JSON.stringify(o)),await performSaveDraftListening(window.location.pathname.split("/").filter(Boolean).pop(),s),NProgress.done(),e.target.disabled=!1,e.target.classList.remove("is-loading"),document.querySelectorAll('input[class^="ui-edit-listening-shortAnswerAnswerPart'+t+'"]').forEach((e=>{e.value=""}));Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Bạn đã thêm câu hỏi mới"})}}else if(e.target&&e.target.className.startsWith("btn btn-outline-primary ui-edit-reading-addNewQuestionPart")){e.preventDefault();const t=e.target.className.match(/\d+/)[0];if("<p><br></p>"==editReadingQuillArray[t-1].root.innerHTML){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn chưa nhập nội dung câu hỏi"})}if(0==document.querySelector("#ui-edit-reading-questionCategorySelectorPart"+t).value){if([...document.querySelectorAll(".ui-edit-reading-multipleChoiceAnswerPart"+t)].some((e=>""===e.value))){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn có một câu trả lời trống"})}e.target.disabled=!0,e.target.classList.add("is-loading"),NProgress.start(),await checkLoginStatus();const n=new Array;document.querySelectorAll('input[class^="ui-edit-reading-multipleChoiceAnswerPart'+t+'"]').forEach((e=>{n.push(e.value)}));const o=[];o.push(parseInt(document.getElementById("ui-edit-reading-correctAnswerSelectPart"+t).value));const i={id:editReadingQuestionCount+=1,question:editReadingQuillArray[t-1].root.innerHTML.trim(),part:t,type:document.getElementById("ui-edit-reading-questionCategorySelectorPart"+t).value,lesson_id:window.location.pathname.split("/").filter(Boolean).pop(),answer:o,options:n};editReadingQuestionsArray.push(i);let a=new String;const r=Array.from({length:26},((e,t)=>String.fromCharCode(65+t)));for(let e=1;e<=n.length;e++)a+=r[e-1]+". "+n[e-1]+"<br>";const s=document.importNode(document.querySelector("#ui-edit-lesson-questionCard").content,!0);s.querySelector('[data-id="question-count"]').textContent="Câu hỏi "+editReadingQuestionCount,s.querySelector('[data-id="question-content"]').innerHTML=editReadingQuillArray[t-1].root.innerHTML+a,s.querySelector('[data-id="div-collapse"]').id=`collapse${editReadingQuestionCount}`,s.querySelector('[data-id="div-collapse"]').innerHTML=n[parseInt(o[0])-1],s.querySelector('[data-id="course-toc"]').id="course-toc-"+editReadingQuestionCount,s.querySelector('[data-id="course-acc"]').setAttribute("data-target","#course-toc-"+editReadingQuestionCount),s.querySelector('[data-id="course-acc"]').setAttribute("data-parent","#ui-edit-listening-accordion-"+editReadingQuestionCount),s.querySelector('[data-id="js-acc"]').id="ui-edit-listening-accordion-"+editReadingQuestionCount,document.querySelector("#ui-edit-reading-questionsContainerPart"+t).appendChild(s),document.getElementById("placeholder_reading_part"+t)&&document.getElementById("placeholder_reading_part"+t).remove(),editReadingQuillArray[t-1].setText("");let l=document.getElementById(`ui-edit-reading-multipleChoiceAnswerContainerPart${t}`)?.firstElementChild?.nextElementSibling;for(;l;){const e=l.nextElementSibling;l.parentNode.removeChild(l),l=e}const c=new FormData;c.append("saveChanges",JSON.stringify(i)),await performSaveDraftReading(window.location.pathname.split("/").filter(Boolean).pop(),c),NProgress.done(),e.target.disabled=!1,e.target.classList.remove("is-loading"),document.querySelector("#ui-edit-reading-correctAnswerSelectPart"+t).querySelectorAll("option").forEach((e=>{"A"!==e.textContent&&document.getElementById("ui-edit-reading-correctAnswerSelectPart"+t).removeChild(e)})),document.querySelectorAll('input[class^="ui-edit-reading-multipleChoiceAnswerPart'+t+'"]').forEach((e=>{e.value=""}));Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Bạn đã thêm câu hỏi mới"})}}else if(e.target&&e.target.className.startsWith("performDeleteFlashcard"))e.preventDefault(),e.target.blur(),Swal.fire({title:"Bạn chắc chắn chứ?",text:"Bạn có chắn chắn muốn xóa thẻ ghi nhớ này? Hành động này là không thể hoàn tác.",icon:"question",showCancelButton:!0,confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Có, tôi chắc chắn",cancelButtonText:"Không, hủy bỏ",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}}).then((async t=>{if(t.isConfirmed){await checkLoginStatus();const t=new FormData;t.append("flashcardId",e.target.getAttribute("data-flashcard-id")),t.append("flashcardLesson",window.location.pathname.split("/").filter(Boolean).pop());const n={saveAction:"delete",saveType:"draft"},o={};t.append("saveChanges",JSON.stringify(o)),t.append("saveSettings",JSON.stringify(n)),t.append("csrf_token",csrf_token);const i=await fetch(apiSubdomain+"edit/flashcard/publish",{method:"POST",body:t});if(!i.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}if("success"!==(await i.json()).message){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}if(Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Bạn đã xóa thẻ ghi nhớ"}),document.querySelector("#ui-edit-flashcardElement-flashcard"+e.target.getAttribute("data-flashcard-id")).remove(),0===document.getElementById("ui-manage-flashcard-flashcardContainer")?.children.length){const e=document.createElement("center");e.id="ui-edit-flashcard-placeholder";const t=document.createElement("div");t.style.backgroundImage="url('https://bunny.net/bn-cookies/Bunny%20Cookies.svg')",t.style.backgroundRepeat="no-repeat",t.style.height="200px",t.style.width="169px",t.style.backgroundSize="contain";const n=document.createElement("br"),o=document.createElement("h5");o.textContent="Bạn chưa thêm thẻ ghi nhớ nào",e.appendChild(t),e.appendChild(n),e.appendChild(o),document.querySelector("#ui-edit-flashcard-placeholderContainer").appendChild(e)}}}));else if(e.target&&e.target.className.startsWith("performEditFlashcard")){e.preventDefault(),e.target.blur(),NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("flashcardId",window.location.pathname.split("/").filter(Boolean).pop()),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/flashcard/details",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();for(let t=0;t<o.flashcards.length;t++)if(Number(o.flashcards[t].id)==Number(e.target.getAttribute("data-flashcard-id"))){const e=o.flashcards[t].answer;editFlashcardQuillArray[0].clipboard.dangerouslyPasteHTML(e[0],"api"),editFlashcardQuillArray[1].clipboard.dangerouslyPasteHTML(e[1],"api"),NProgress.done(),document.querySelector("#ui-edit-flashcard-flashcardEditor")?.scrollIntoView({behavior:"smooth"});break}}else{if(e.target.closest(".no-flip"))return;const t=e.target.closest(".flip");if(!t)return;t.classList.toggle("flipped"),setPointerEventsFlipcard(t,t.classList.contains("flipped"))}})),document.querySelector("#ui-manage-lessons-createArticle").addEventListener("click",(async function(e){e.preventDefault(),await NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("courseId",window.location.pathname.split("/").filter(Boolean).pop()),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/article/initialize",{body:t,method:"POST"});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}await n.json();await loadEditArticlePage(n.lessonId)})),document.querySelector("#ui-edit-article-publishButton").addEventListener("click",(async function(e){e.preventDefault(),e.target.blur(),Swal.fire({title:"Bạn chắc chắn chứ?",text:"Bạn có chắn chắn muốn xuất bản bài giảng này? Bạn luôn có thể chỉnh sửa bài giảng này bất kỳ lúc nào.",icon:"question",showCancelButton:!0,confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Có, tôi chắc chắn",cancelButtonText:"Không, hủy bỏ",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}}).then((async t=>{if(t.isConfirmed){e.target.disabled=!0,e.target.classList.add("is-loading"),safeToExit=!1;const t=new FormData;t.append("articleId",window.location.pathname.split("/").filter(Boolean).pop()),t.append("action","publish"),t.append("csrf_token",csrf_token);await fetch(apiSubdomain+"edit/article/publish",{method:"POST",body:t});safeToExit=!0,Swal.fire({title:"Thành công!",confirmButtonColor:"#5567ff",confirmButtonText:"Đóng",text:"Bạn đã xuất bản bài giảng này. Bạn có thể chỉnh sửa bài giảng này bất kỳ lúc nào.",icon:"success",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}})}}))})),$("#ui-edit-article-addToCourseSelect").on("select2:select",(async function(){const e=$("#ui-edit-article-addToCourseSelect").select2("data"),t=new FormData;t.append("articleCourse",JSON.stringify(e.map((e=>parseInt(e.id,10))))),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/article/sections",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();if("success"===o.message)document.getElementById("ui-edit-article-addToSectionSelect").replaceChildren(),o.section.forEach((e=>{const t=document.importNode(document.querySelector("#ui-select2-option-element").content,!0);t.querySelector('[data-id="option"]').textContent=e.name,t.querySelector('[data-id="option"]').value=e.id,document.querySelector("#ui-edit-article-addToSectionSelect").appendChild(t)}));else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}})),document.querySelector("#ui-edit-article-nameField").addEventListener("input",function(){let e;return async function(t){clearTimeout(e),document.getElementById("ui-edit-article-syncStatusText").textContent="Đang lưu bản nháp",e=setTimeout((async()=>{saveChangesEditArticle(window.location.pathname.split("/").filter(Boolean).pop())}),1e3)}}()),document.querySelector("#ui-manage-lessons-createButton").addEventListener("click",(async function(e){e.preventDefault(),await NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/news/initialize",{body:t,method:"POST"});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();await loadEditNewsPage(o.newsId)})),document.addEventListener("keydown",(function(e){if(e.ctrlKey&&"k"===e.key){e.preventDefault();const t=document.getElementById("ui-textArea-searchForm");t&&t.focus()}})),document.querySelector("#ui-edit-account-submit-button").addEventListener("click",(async function(e){e.preventDefault();const t=document.getElementById("a");if(t||0===!t.files.length)try{const e=new FormData;e.append("image",document.getElementById("ui-edit-account-avatarFieldInput").files[0]);const t=await fetch(apiSubdomain+"account/upload",{method:"POST",body:e});if(!t.ok)throw new Error(`Upload failed with status ${t.status}`);const n=await t.json();return console.log("Upload successful:",n),n}catch(e){throw console.error("Error uploading image:",e),e}})),document.addEventListener("keyup",(function(e){const t=e.target.parentElement.parentElement;if(!t||!t.id)return;const n=t.id.match(/\d+/);if(n&&n[0])if(e.target&&e.target.classList.contains("ui-edit-listening-multipleChoiceAnswerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0])){if("Enter"===e.key){if(24===document.getElementById("ui-edit-listening-multipleChoiceAnswerContainerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0]).childElementCount){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Số câu trả lời đã đạt giới hạn"})}const t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.marginTop="1rem";const n=document.createElement("span");n.className="material-icons ui-edit-listening-deleteMultipleChoiceAnswer",n.style.opacity="0.3",n.style.cursor="pointer",n.style.userSelect="none",n.textContent="close";const o=document.createElement("input");o.style.marginLeft="5px",o.type="text",o.className="ui-edit-listening-multipleChoiceAnswerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0]+" form-control",o.placeholder="Câu trả lời...",t.appendChild(n),t.appendChild(o);document.querySelector("#ui-edit-listening-multipleChoiceAnswerContainerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0]).appendChild(t),o.focus();const i=document.getElementById(`ui-edit-listening-correctAnswerSelectPart${e.target.parentElement.parentElement.id.match(/\d+/)[0]}`),a=i.options[i.options.length-1],r=parseInt(a.value)+1;i.add(new Option(String.fromCharCode(64+r),r))}}else if(e.target&&e.target.classList.contains("ui-edit-reading-multipleChoiceAnswerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0])&&"Enter"===e.key){if(24===document.getElementById("ui-edit-reading-multipleChoiceAnswerContainerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0]).childElementCount){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Số câu trả lời đã đạt giới hạn"})}const t=document.createElement("div");t.style.display="flex",t.style.alignItems="center",t.style.marginTop="1rem";const n=document.createElement("span");n.className="material-icons ui-edit-reading-deleteMultipleChoiceAnswer",n.style.opacity="0.3",n.style.cursor="pointer",n.style.userSelect="none",n.style.fontSize="17px",n.textContent="close";const o=document.createElement("input");o.style.marginLeft="5px",o.style.fontSize=".9rem",o.type="text",o.className="ui-edit-reading-multipleChoiceAnswerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0]+" form-control",o.placeholder="Câu trả lời...",t.appendChild(n),t.appendChild(o);document.querySelector("#ui-edit-reading-multipleChoiceAnswerContainerPart"+e.target.parentElement.parentElement.id.match(/\d+/)[0]).appendChild(t),o.focus();const i=document.getElementById(`ui-edit-reading-correctAnswerSelectPart${e.target.parentElement.parentElement.id.match(/\d+/)[0]}`),a=i.options[i.options.length-1],r=parseInt(a.value)+1;i.add(new Option(String.fromCharCode(64+r),r))}})),document.querySelector("#ui-edit-listening-chooseCoverImageFileInput").addEventListener("change",(function(e){const t=e.target.files;if(t.length>0){const e=t[0].name;document.querySelector("#ui-edit-listening-choosenFileName").textContent=e}else document.querySelector("#ui-edit-listening-choosenFileName").textContent="Chưa có hình ảnh"})),document.getElementById("ui-edit-listening-publishButton").addEventListener("click",(async function(){Swal.fire({title:"Bạn chắc chắn chứ?",text:"Bạn có chắn chắn muốn xuất bản bài tập này? Bạn luôn có thể chỉnh sửa bài tập này bất kỳ lúc nào.",icon:"question",showCancelButton:!0,confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Có, tôi chắc chắn",cancelButtonText:"Không, hủy bỏ",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}}).then((async e=>{if(e.isConfirmed){await checkLoginStatus(),NProgress.start();const e=Array(),t=Array.from(document.querySelectorAll('input[id^="ui-edit-listening-chooseAudioFilePart"]')),n=e=>new Promise(((t,n)=>{const o=new FormData;o.append("audioFile",e),o.append("csrf_token",csrf_token);fetch(apiSubdomain+"edit/listening/upload",{method:"POST",body:o}).then((e=>e.json())).then((e=>{t(e.fileURL)})).catch((e=>{n(e)}))}));for(const o of t){const t=o.files[0];if(t)try{const o=await n(t);e.push(o)}catch(e){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Không thể tải lên tệp tin"})}}NProgress.done();const o={saveType:"publish"},i=new FormData;if(i.append("saveSettings",JSON.stringify(o)),i.append("saveChanges",JSON.stringify({})),i.append("lessonAudios",JSON.stringify(e)),i.append("lessonId",window.location.pathname.split("/").filter(Boolean).pop()),i.append("csrf_token",csrf_token),!await fetch(apiSubdomain+"edit/listening/publish",{method:"POST",body:i}).ok){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}Swal.fire({title:"Thành công!",confirmButtonColor:"#5567ff",confirmButtonText:"Đóng",text:"Bạn đã xuất bản bài tập này. Bạn có thể chỉnh sửa bài tập này bất kỳ lúc nào.",icon:"success",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}})}}))})),document.querySelector("#ui-edit-listening-lessonNameTextField").addEventListener("input",(function(e){safeToExit=!1,document.getElementById("ui-edit-flashcard-syncStatusText").textContent="Đang lưu bản nháp",document.getElementById("ui-edit-flashcard-syncStatusIcon").textContent="sync",clearTimeout(e.target.dataset.timer),e.target.dataset.timer=setTimeout((()=>{const t=new FormData;t.append("saveChanges",JSON.stringify({})),t.append("lessonName",e.target.value),performSaveDraftListening(window.location.pathname.split("/").filter(Boolean).pop(),t)}),1e3)})),document.querySelector("#ui-edit-listening-oneTimeAllowCheckbox").addEventListener("input",function(){let e=null;return function(){clearTimeout(e),document.getElementById("ui-edit-listening-syncStatusText").textContent="Đang lưu bản nháp",document.getElementById("ui-edit-listening-syncStatusIcon").textContent="sync",e=setTimeout((()=>{const e=new FormData;performSaveDraftListening(window.location.pathname.split("/").filter(Boolean).pop(),e)}),1e3)}}()),document.querySelector("#ui-edit-flashcard-publishButton").addEventListener("click",(async function(e){e.preventDefault(),e.target.blur(),e.target.disabled=!0,e.target.classList.add("is-loading");const t=new FormData;t.append("saveChanges",JSON.stringify({})),t.append("saveSettings",JSON.stringify({saveType:"publish"})),t.append("lessonId",window.location.pathname.split("/").filter(Boolean).pop()),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"edit/flashcard/publish",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}if("success"===(await n.json()).message)Swal.fire({title:"Thành công!",confirmButtonColor:"#5567ff",confirmButtonText:"Đóng",text:"Bạn đã xuất bản thẻ ghi nhớ này. Bạn có thể chỉnh sửa thẻ ghi nhớ này bất kỳ lúc nào.",icon:"success",customClass:{confirmButton:"swalConformButton",cancelButton:"swalCancelButton"}}).then((e=>{e.isConfirmed&&loadLesson(window.location.pathname.split("/").filter(Boolean).pop())})),e.target.disabled=!1,e.target.classList.remove("is-loading");else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}})),document.getElementById("ui-edit-flashcard-flashcardNameTextField").addEventListener("input",(function(e){safeToExit=!1,document.getElementById("ui-edit-flashcard-syncStatusText").textContent="Đang lưu bản nháp",document.getElementById("ui-edit-flashcard-syncStatusIcon").textContent="sync",clearTimeout(e.target.dataset.timer),e.target.dataset.timer=setTimeout((async()=>{const t=new FormData;t.append("saveChanges",JSON.stringify({})),t.append("saveSettings",JSON.stringify({saveType:"draft"})),t.append("flashcardName",e.target.value),t.append("flashcardId",window.location.pathname.split("/").filter(Boolean).pop()),t.append("csrf_token",csrf_token),await fetch(apiSubdomain+"edit/flashcard/publish",{method:"POST",body:t}),document.getElementById("ui-edit-flashcard-syncStatusText").textContent="Đã lưu bản nháp",document.getElementById("ui-edit-flashcard-syncStatusIcon").textContent="done_all",safeToExit=!0,document.title=e.target.value}),1e3)})),document.querySelector("#ui-edit-flashcard-chooseCoverImageFileInput").addEventListener("change",(function(){document.querySelector("#ui-edit-flashcard-chooseCoverImageFileInput").files.length>0?document.querySelector("#ui-edit-flashcard-choosenFileName").textContent=document.querySelector("#ui-edit-flashcard-chooseCoverImageFileInput").files[0].name:document.querySelector("#ui-edit-flashcard-choosenFileName").textContent="Chưa có hình ảnh"})),document.getElementById("ui-edit-flashcard-chooseAudioFrontInput").addEventListener("change",(function(){document.querySelector("#ui-edit-flashcard-chooseAudioFrontInput").files&&document.querySelector("#ui-edit-flashcard-chooseAudioFrontInput").files.length>0?document.querySelector("#ui-edit-flashcard-chooseAudioFrontLabel").textContent=document.getElementById("ui-edit-flashcard-chooseAudioFrontInput").files[0].name:document.querySelector("#ui-edit-flashcard-chooseAudioFrontLabel").textContent="Chưa có âm thanh"})),document.querySelector("#ui-edit-flashcard-chooseAudioBackInput").addEventListener("change",(function(){document.querySelector("#ui-edit-flashcard-chooseAudioBackInput").files&&document.querySelector("#ui-edit-flashcard-chooseAudioBackInput").files.length>0?document.querySelector("#ui-edit-flashcard-chooseAudioBackLabel").textContent=document.querySelector("#ui-edit-flashcard-chooseAudioBackInput").files[0].name:document.querySelector("#ui-edit-flashcard-chooseAudioBackLabel").textContent="Chưa có âm thanh"})),document.querySelector("#ui-edit-reading-publishButton").addEventListener("click",(function(e){e.preventDefault(),e.target.blur()}));const video=document.getElementById("video");let stream=null,detectionInterval=null,violationCounter=0,noFaceDetectedStartTime=null;const NO_FACE_THRESHOLD_MS=5e3;let shouldEnableProctoring=!1;async function loadFaceApiModelsOnce(){if(!faceApiModelsLoaded)return faceApiModelLoadingPromise||(faceApiModelLoadingPromise=Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri("https://cdn.jsdelivr.net/gh/justadudewhohacks/face-api.js@0.22.2/weights"),faceapi.nets.faceLandmark68Net.loadFromUri("https://cdn.jsdelivr.net/gh/justadudewhohacks/face-api.js@0.22.2/weights"),faceapi.nets.faceRecognitionNet.loadFromUri("https://cdn.jsdelivr.net/gh/justadudewhohacks/face-api.js@0.22.2/weights"),faceapi.nets.faceExpressionNet.loadFromUri("https://cdn.jsdelivr.net/gh/justadudewhohacks/face-api.js@0.22.2/weights")]).then((()=>{faceApiModelsLoaded=!0})).catch((e=>{throw faceApiModelsLoaded=!1,console.error(`Error loading models: ${e.message}. Please check your internet connection.`),console.error("Error loading face-api models:",e),e}))),faceApiModelLoadingPromise}async function startProctoring(){const e=document.getElementById("overlayCanvas");try{stream=await navigator.mediaDevices.getUserMedia({video:!0}),video.srcObject=stream,video.onloadedmetadata=()=>{e.width=video.videoWidth,e.height=video.videoHeight,detectionInterval=setInterval(detectFace,1)}}catch(e){console.error("Error accessing webcam:",e)}}async function startProctoring(){const e=document.getElementById("overlayCanvas");try{await loadFaceApiModelsOnce(),stream=await navigator.mediaDevices.getUserMedia({video:!0}),video.srcObject=stream,video.onloadedmetadata=()=>{e.width=video.videoWidth,e.height=video.videoHeight,detectionInterval=setInterval(detectFace,100)}}catch(e){console.error("Error starting proctoring:",e)}}async function detectFace(){const e=document.getElementById("overlayCanvas");if(video.paused||video.ended)return;const t=await faceapi.detectAllFaces(video,new faceapi.TinyFaceDetectorOptions).withFaceLandmarks().withFaceExpressions(),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);const o={width:video.videoWidth,height:video.videoHeight},i=faceapi.resizeResults(t,o);n.drawImage(video,0,0,e.width,e.height),faceapi.draw.drawDetections(e,i),faceapi.draw.drawFaceLandmarks(e,i),faceapi.draw.drawFaceExpressions(e,i),0===i.length?null===noFaceDetectedStartTime?noFaceDetectedStartTime=Date.now():Date.now()-noFaceDetectedStartTime>NO_FACE_THRESHOLD_MS&&!0===shouldEnableProctoring&&(!1===showingCheatingAlert&&Swal.fire({title:"Nhắc nhở",text:"Hãy ngồi ngay ngắn và nhìn thẳng vào màn hình để tiếp tục làm bài.",icon:"warning",showCancelButton:!1,confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Đã hiểu",customClass:{confirmButton:"swalConformButton"}}),showingCheatingAlert=!0,violationCounter++,console.warn("Violation: No face detected!"),document.querySelector("#root").style.filter="blur(20px)",sendViolationToBackend("no_face_detected"),noFaceDetectedStartTime=null):(showingCheatingAlert=!1,document.querySelector("#root").style.filter="blur(0px)",noFaceDetectedStartTime=null)}async function sendViolationToBackend(e){console.log(`Simulating sending violation to backend: ${e}`)}async function performSendComment(e,t,n){e.target.disabled=!0,e.target.blur(),e.target.classList.add("is-loading");const o=new FormData;o.append("commentParentId",n),o.append("commentContent",document.querySelector(t).value.trim()),o.append("postId",window.location.pathname.split("/").filter(Boolean).pop()),o.append("csrf_token",csrf_token);const i=await fetch(apiSubdomain+"comments/create",{method:"POST",body:o});if(!i.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const a=await i.json();if("success"===a.message)e.target.disabled=!1,e.target.classList.remove("is-loading");else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:a.message})}}async function loadLesson(e){document.querySelector("#ui-lesson-details-submitedOn").style.display="none",document.querySelector("#ui-lesson-details-restartQuiz").style.display="none",document.querySelector("#ui-lesson-details-question-container").style.display="none",document.querySelector("#ui-lesson-details-article-container").style.display="none",document.getElementById("ui-lesson-details-reading-container").style.display="none",NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("lesson_id",e);const n=await fetch(apiSubdomain+"lessons/details",{method:"POST",body:t});if(!n.ok)return void alert("Something went wrong...");const o=await n.json();if(document.getElementById("ui-lesson-details-question-container").style.display="none",document.getElementById("ui-lesson-details-article-container").style.display="none",document.querySelector("#ui-lesson-details-flashcard-container").style.display="none",document.querySelector(".ui-lesson-details-timer").style.display="none",document.querySelector("#ui-lesson-details-comment-root").style.display="none",0===o.informations.skill){if(document.querySelector("#ui-lesson-details-question-container").style.display="block",document.getElementById("ui-lesson-details-question-container").style.display="block",document.querySelector(".ui-lesson-details-timer").style.display="block",!o.success)return void alert("Something went wrong...");const a=new FormData;a.append("lesson_id",e),a.append("course_id",o.informations.courseId[0]),await fetch(apiSubdomain+"recent/update",{method:"POST",body:a}),document.querySelector("#ui-lesson-details-question-container").innerHTML="",lessonQuestionCount=o.questions.length;const r=o.informations.lessonAudios;for(let l=1;l<=r.length;l++){let c=`<audio controls class="ui-lesson-details-audioplayer"><source src="${r[l-1]}" type="audio/mp3" /></audio>`;o.questions.forEach(((t,n)=>{c+=`<div class="border-left-2 page-section pl-32pt"><div class="d-flex align-items-center page-num-container mb-16pt"><div class="page-num">${n+1}</div><h4 id="ui-lesson-details-question${n+1}">${t.question}</h4></div><ul class="list-quiz">`;for(let e=0;e<JSON.parse(t.options).length;e++){const o=Array.from({length:26},((e,t)=>String.fromCharCode(65+t)));c+=`<li class="list-quiz-item" style="cursor: pointer"><span class="list-quiz-badge" id="ui-lesson-details-question${n+1}-option${o[e]}" onclick="selectOptionRadioAction('ui-lesson-details-question${n+1}-option${o[e]}')">${o[e]}</span><span class="list-quiz-text" style="font-size: 1rem" onclick="selectOptionRadioAction('ui-lesson-details-question${n+1}-option${o[e]}')">${JSON.parse(t.options)[e]}</span></li>`}document.getElementById("ui-lesson-details-question-container").insertAdjacentHTML("beforeend",c),c="",n+1===o.questions.length&&document.querySelector("#ui-lesson-details-question-container").insertAdjacentHTML("beforeend",`<button class="btn btn-primary btn-block" style="margin-top: 1rem; margin-bottom: 1rem" onclick="submitLessonAction(this, '${e}')">Nộp bài</button>`)}))}const s=o.informations.lessonSettings;document.getElementById("ui-lesson-details-coursename").textContent=o.informations.courseName,document.getElementById("ui-lesson-details-backtocourse").href="/dashboard/"+localStorage.getItem("currentCourse"),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("lesson-details").forEach((e=>e.style.display="block")),document.querySelectorAll(".ui-lesson-details-authorAvatar").forEach((e=>e.src=o.informations.authorAvatar)),document.querySelectorAll(".ui-lesson-details-authorFullname").forEach((e=>e.textContent=o.informations.authorFullname)),switchPages(),document.querySelector("#ui-lesson-details-timertext").textContent="Thời gian còn lại: "+s.timeLimit+":00",document.title=o.informations.name,NProgress.done(),Audioplayer=new Plyr(".ui-lesson-details-audioplayer"),!0===o.informations.lessonSettings.oneTime?Swal.fire({title:"Lưu ý",text:"Bạn chỉ được phép làm bài tập này một lần duy nhất. Hãy kiểm tra thật kỹ trước khi nộp bài nhé",icon:"warning",confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Đã hiểu",customClass:{confirmButton:"swalConformButton"}}).then((()=>{!0===o.informations.lessonSettings.antiCheat?Swal.fire({title:"Lưu ý",text:"Bạn đang bị giám sát tự động, vui lòng không thoát khỏi chế độ toàn màn hình, chuyển sang cửa sổ khác hoặc rời mắt khỏi màn hình trong lúc làm bài",icon:"warning",confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Đã hiểu",customClass:{confirmButton:"swalConformButton"}}).then((()=>{Swal.fire({title:"Kiểm tra camera của bạn",icon:"info",allowEscapeKey:!1,html:'\n                            <p>Hãy đảm bảo đủ sáng và ngồi ngay ngắn để camera có thể nhận diện được khuôn mặt của bạn</p>\n    <canvas id="overlayCanvas" style="width: 640px; height: 480px;"></canvas>\n  ',showCloseButton:!1,allowOutsideClick:!1,width:700,focusConfirm:!1,confirmButtonText:"\n    Đã sẵng sàng\n  ",customClass:{confirmButton:"swalConformButton"}}).then((()=>{stopProctoring();const e=document.importNode(document.getElementById("proctoringCanvas").content,!0);e.querySelector("[data-id='overlayCanvas']").id="overlayCanvas",document.body.prepend(e),document.documentElement.requestFullscreen(),startProctoring(),shouldEnableProctoring=!0,0!=s.timeLimit?startSmoothTimer(6e4*s.timeLimit):document.querySelector(".ui-lesson-details-timer").style.display="none"})),startProctoring()})):0!=s.timeLimit?startSmoothTimer(6e4*s.timeLimit):document.querySelector(".ui-lesson-details-timer").style.display="none"})):0!=s.timeLimit?startSmoothTimer(6e4*s.timeLimit):document.querySelector(".ui-lesson-details-timer").style.display="none",document.querySelector("#ui-lesson-details-addToFavoriteButton").setAttribute("onclick","addToFavourite(this, '2541032598')")}else if(5===o.informations.skill){const d=new FormData;if(d.append("postId",e),!0===o.informations.articleSettings.allowComments){const u=await fetch(apiSubdomain+"comments/comments",{method:"POST",body:d});if(!u.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const m=await u.json();if("success"!=m.message){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}m.comments.length>0&&m.comments.forEach((e=>{})),document.querySelector("#ui-lesson-details-comment-root").style.display="block"}document.title=o.informations.articleName,document.getElementById("ui-lesson-details-article-container").style.display="block",document.querySelector("#ui-lesson-details-article-container").innerHTML=o.informations.articlePassages[0],document.querySelector("#ui-lesson-details-timertext").textContent=o.informations.articleName,document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("lesson-details").forEach((e=>e.style.display="block")),switchPages(),NProgress.done()}else if(2===o.informations.skill){if(document.getElementById("ui-lesson-details-reading-container").style.display="block",document.getElementById("ui-lesson-details-reading-container").style.display="block",document.querySelector(".ui-lesson-details-timer").style.display="block",!o.success){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const p=new FormData;p.append("lesson_id",e),p.append("course_id",JSON.parse(o.informations.courseId)[0]),await fetch(apiSubdomain+"recent/update",{method:"POST",body:p}),lessonQuestionCount=o.questions.length;for(let h=0;h<o.informations.lessonPassages.length;h++){const g=document.createElement("div");g.className="row";const f=document.createElement("div");f.className="col-md-6";const y=document.createElement("div");y.className="page-separator";const w=document.createElement("div");w.className="page-separator__text",w.textContent="Bài đọc phần "+[h+1],y.appendChild(w),f.appendChild(y);const v=document.createElement("div");v.id="ui-view-reading-passage-holder-part"+[h+1],v.className="text-70",v.style.fontSize="1rem",v.style.textAlign="justify",v.style.maxHeight="1000px",f.appendChild(v),g.appendChild(f);const S=document.createElement("div");S.className="col-md-6";const b=document.createElement("div");b.className="page-separator";const C=document.createElement("div");C.className="page-separator__text",C.textContent="Câu hỏi phần "+[h+1],b.appendChild(C),S.appendChild(b);const x=document.createElement("div");x.id="ui-view-reading-question-holder-part"+[h+1],x.style.maxHeight="1000px",x.style.overflow="auto",x.style.paddingLeft="20px",x.className="text-70",x.style.fontSize="1rem",S.appendChild(x);const B=document.createElement("button");B.className="btn btn-primary btn-block",B.textContent="Nộp bài",B.style.marginTop="1rem",B.setAttribute("onclick","submitLessonAction(this, '"+e+"')"),S.appendChild(B),g.appendChild(S),document.querySelector("#ui-lesson-details-reading-container").appendChild(g);const q=await new Quill("#ui-view-reading-passage-holder-part"+[h+1],{theme:"bubble",modules:{toolbar:[[{background:[]}]]}});q.clipboard.dangerouslyPasteHTML(o.informations.lessonPassages[h]),document.querySelector("#ui-view-reading-passage-holder-part"+(h+1)).style.setProperty("background-color","transparent","important");q.root.addEventListener("keydown",(e=>{1===e.key.length&&!e.ctrlKey&&!e.metaKey&&!e.altKey&&e.preventDefault()})),q.clipboard.addMatcher(Node.TEXT_NODE,((e,t)=>new Delta)),q.clipboard.addMatcher(Node.ELEMENT_NODE,((e,t)=>t.filter((e=>!e.insert||"string"==typeof e.insert&&""===e.insert.trim()))));for(let E=0;E<o.questions.length;E++){function i(e,t,n){const o=document.createElement("li");o.className="list-quiz-item",o.style.cursor="pointer";const i=document.createElement("span");i.className="list-quiz-badge",i.id=`ui-lesson-details-${e}-option${t}`,i.textContent=t,i.setAttribute("onclick","selectOptionRadioAction('"+i.id+"')");const a=document.createElement("span");return a.className="list-quiz-text",a.style.fontSize="1rem",a.textContent=n,a.onclick=function(){selectOptionRadioAction(i.id)},o.appendChild(i),o.appendChild(a),o}const k=Array.from({length:26},((e,t)=>String.fromCharCode(65+t))),L=document.importNode(document.getElementById("view-questionElement").content,!0);L.querySelector("[data-id='question-name']").innerHTML=o.questions[E].question,L.querySelector("[data-id='question-name']").id="ui-lesson-details-question"+[E+1],L.querySelector("[data-id='page-num']").textContent=[E+1];for(let T=0;T<o.questions[E].options.length;T++)L.querySelector("[data-id='list-quiz']").appendChild(i("question"+[E+1],k[T],o.questions[E].options[T]));document.querySelector("#ui-view-reading-question-holder-part"+[h+1]).appendChild(L)}}!0===o.informations.lessonSettings.oneTime?Swal.fire({title:"Lưu ý",text:"Bạn chỉ được phép làm bài tập này một lần duy nhất. Hãy kiểm tra thật kỹ trước khi nộp bài nhé",icon:"warning",confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Đã hiểu",customClass:{confirmButton:"swalConformButton"}}).then((()=>{!0===o.informations.lessonSettings.antiCheat?Swal.fire({title:"Lưu ý",text:"Bạn đang bị giám sát tự động, vui lòng không thoát khỏi chế độ toàn màn hình, chuyển sang cửa sổ khác hoặc rời mắt khỏi màn hình trong lúc làm bài",icon:"warning",confirmButtonColor:"#5567ff",cancelButtonColor:"#d33",confirmButtonText:"Đã hiểu",customClass:{confirmButton:"swalConformButton"}}).then((()=>{Swal.fire({title:"Kiểm tra camera của bạn",icon:"info",allowEscapeKey:!1,html:'\n                            <p>Hãy đảm bảo đủ sáng và ngồi ngay ngắn để camera có thể nhận diện được khuôn mặt của bạn</p>\n    <canvas id="overlayCanvas" style="width: 640px; height: 480px;"></canvas>\n  ',showCloseButton:!1,allowOutsideClick:!1,width:700,focusConfirm:!1,confirmButtonText:"\n    Đã sẵng sàng\n  ",customClass:{confirmButton:"swalConformButton"}}).then((()=>{stopProctoring();const e=document.importNode(document.getElementById("proctoringCanvas").content,!0);e.querySelector("[data-id='overlayCanvas']").id="overlayCanvas",document.body.prepend(e),document.documentElement.requestFullscreen(),startProctoring(),shouldEnableProctoring=!0,0!=o.informations.lessonSettings.timeLimit?startSmoothTimer(6e4*o.informations.lessonSettings.timeLimit):document.querySelector(".ui-lesson-details-timer").style.display="none"})),startProctoring()})):0!=o.informations.lessonSettings.timeLimit?startSmoothTimer(6e4*o.informations.lessonSettings.timeLimit):document.querySelector(".ui-lesson-details-timer").style.display="none"})):0!=o.informations.lessonSettings.timeLimit?startSmoothTimer(6e4*o.informations.lessonSettings.timeLimit):document.querySelector(".ui-lesson-details-timer").style.display="none",document.querySelectorAll(".ui-lesson-details-authorAvatar").forEach((e=>{e.src=o.informations.authorAvatar})),document.querySelectorAll(".ui-lesson-details-authorFullname").forEach((e=>{e.textContent=o.informations.authorFullname})),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("lesson-details").forEach((e=>e.style.display="block")),switchPages(),NProgress.done()}else if(6===o.informations.skill){const P=new FormData;if(P.append("postId",e),!0===o.informations.lessonSettings.allowComments){const A=await fetch(apiSubdomain+"comments/comments",{method:"POST",body:P});if(!A.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const _=await A.json();if("success"!=_.message){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}document.querySelector("#ui-lesson-details-commentCounter").textContent=_.comments.length+" câu hỏi",[...document.querySelector("#ui-lesson-details-comment-container").children].forEach((e=>e.remove())),_.comments.length>0&&_.comments.forEach((e=>{const t=document.importNode(document.getElementById("commentElement").content,!0);t.querySelector("[data-id='fullname']").textContent=e.user_id,t.querySelector("[data-id='avatar']").setAttribute("src",e.user_avatar),t.querySelector("[data-id='content']").textContent=e.content,t.querySelector("[data-id='favorite-button']").setAttribute("onclick","addToFavourite(this, 'comment_"+e.id+"')"),document.querySelector("#ui-lesson-details-comment-container").appendChild(t)})),document.querySelector("#ui-lesson-details-comment-root").style.display="block",document.querySelector("#ui-lesson-details-mainCommentUserFullname").textContent=_.user.fullname,document.getElementById("ui-lesson-details-mainCommentUserAvatar").setAttribute("src",_.user.avatar)}[...document.querySelector("#ui-lesson-details-flashcardCarousel-inner").children].forEach((e=>e.remove())),document.querySelector("#ui-lesson-details-flashcard-container").style.display="block",document.title=o.informations.name,document.querySelector("#ui-lesson-details-timertext").textContent=o.informations.name,o.flashcards.forEach(((e,t)=>{const n=document.importNode(document.querySelector("#flashcardCarouselElement").content,!0).querySelector("[data-id='carouselElement']");0===t&&n.classList.add("active"),null!==o.flashcards[t].options&&null!==o.flashcards[t].options[0]&&n.querySelector("[data-id='audioFront']").setAttribute("data-audio",o.flashcards[t].options[0]),null!==o.flashcards[t].options&&null!==o.flashcards[t].options[1]&&n.querySelector("[data-id='audioBack']").setAttribute("data-audio",o.flashcards[t].options[1]),n.querySelector("[data-id='front']").insertAdjacentHTML("beforeend",o.flashcards[t].answer[0]),n.querySelector("[data-id='back']").insertAdjacentHTML("beforeend",o.flashcards[t].answer[1]),setPointerEventsFlipcard(n,n.classList.contains("flipped")),document.querySelector("#ui-lesson-details-flashcardCarousel-inner").appendChild(n)})),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("lesson-details").forEach((e=>e.style.display="block")),switchPages(),NProgress.done()}}async function performCreateNewListeningLesson(e,t){e.preventDefault(),NProgress.start(),await checkLoginStatus();const n=new FormData;n.append("csrf_token",csrf_token),n.append("courseId",t);const o=await fetch(apiSubdomain+"edit/listening/initialize",{method:"POST",body:n}),i=await o.json();if(o.ok)if("success"===i.message){window.history.pushState({},"","/edit/"+i.lessonId),document.title="Bài tập chưa có tên",document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("edit-listening").forEach((e=>e.style.display="block"));Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Đã khởi tạo bài tập mới thành công"})}else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Không thể khởi tạo bài tập mới"})}else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Không thể khởi tạo bài tập mới"})}NProgress.done(),await loadEditListeningPage(i.lessonId)}async function selectOptionRadioAction(e){const t=e.match(/\d+/)[0],n=document.getElementById(e);document.querySelectorAll(`[id^='ui-lesson-details-question${t}-option']`).forEach((e=>{e.classList.remove("bg-primary","text-white"),e.textContent=e.id.match(/[A-Z]/)[0]})),n.innerHTML='<i class="material-icons">check</i>',n.classList.add("bg-primary","text-white")}async function loadDashboard(e){localStorage.setItem("currentCourse",e),NProgress.start(),await checkLoginStatus();const t=new FormData;t.append("id",e),t.append("csrf_token",csrf_token);const n=new FormData;n.append("course_id",e);const o=await fetch(apiSubdomain+"recent/get",{method:"POST",body:n}),i=await o.json();document.querySelector("#ui-dashboard-continueRecentButton").href="/lesson/"+i.informations.lessonId,document.getElementById("ui-dashboard-recentName").textContent=i.informations.lessonName,document.getElementById("ui-dashboard-recentCreatedAt").textContent=i.informations.createdAt,document.querySelector("#ui-dashboard-questionCount").textContent=i.informations.lessonQuestionsCount+" câu hỏi";const a=await fetch(apiSubdomain+"dashboard/dashboard",{method:"POST",body:t});if(a.ok){const t=await a.json();if(document.title=t.informations.name,document.querySelectorAll(".ui-dashboard-coursename").forEach((n=>{n.textContent=t.informations.name,n.href="/dashboard/"+e})),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("dashboard").forEach((e=>e.style.display="block")),document.querySelector("#ui-dashboard-root").replaceChildren(),t.listening.length>0){const e=t.listening.reduce(((e,t)=>(e[t.section_id]||(e[t.section_id]=[]),e[t.section_id].push(t),e)),{});Object.keys(e).forEach((t=>{const n=e[t][0].section_name,o=document.createElement("div");o.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent=n,o.appendChild(i),document.querySelector("#ui-dashboard-root").appendChild(o),listeningContainerDiv=document.createElement("div"),listeningContainerDiv.className="row card-group-row",listeningContainerDiv.id="ui-dashboard-container"+t,document.querySelector("#ui-dashboard-root").appendChild(listeningContainerDiv)})),t.listening.forEach((e=>{const t=`<div class="col-lg-3 card-group-row__col">\n                                        <div class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay card-group-row__card" data-toggle="popover" data-trigger="click" data-original-title="" title="" data-domfactory-upgraded="overlay">\n                                            <a href="/lesson/${e.id}" class="card-img-top js-image load" data-position="center" data-height="140" data-domfactory-upgraded="image" style="display: block; position: relative; overflow: hidden; background-image: url(&quot;http://localhost/public/images/paths/flinto_430x168.png&quot;); background-size: cover; background-position: center center; height: 140px;">\n                                                <img src="/public/images/paths/flinto_430x168.png" alt="course" style="visibility: hidden;">\n                                                <span class="overlay__content">\n                                                    <span class="overlay__action d-flex flex-column text-center">\n                                                        <i class="material-icons icon-32pt">play_circle_outline</i>\n                                                        <span class="card-title text-white">Resume</span>\n                                                    </span>\n                                                </span>\n                                            </a>\n\n                                            <div class="card-body flex">\n                                                <div class="d-flex">\n                                                    <div class="flex">\n                                                        <a class="load card-title" href="/lesson/${e.id}">${e.name}</a>\n                                                        <small class="text-50 font-weight-bold mb-4pt">Elijah Murray</small>\n                                                    </div>\n                                                    <a href="javascript:void(0)" class="ml-4pt material-icons text-20 card-course__icon-favorite" onclick="addToFavourite(this, '${e.id}')">favorite_border</a>\n                                                </div>\n                                            </div>\n                                            <div class="card-footer">\n                                                <div class="row justify-content-between">\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">access_time</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>6 hours</small></p>\n                                                    </div>\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">play_circle_outline</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>12 lessons</small></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>`;document.querySelector("#ui-dashboard-container"+e.section_id).insertAdjacentHTML("beforeend",t)}))}if(t.article.length>0){const e=t.article.reduce(((e,t)=>(e[t.section_id]||(e[t.section_id]=[]),e[t.section_id].push(t),e)),{});Object.keys(e).forEach((t=>{const n=e[t][0].section_name,o=document.createElement("div");o.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent=n,o.appendChild(i),document.querySelector("#ui-dashboard-root").appendChild(o),listeningContainerDiv=document.createElement("div"),listeningContainerDiv.className="row card-group-row",listeningContainerDiv.id="ui-dashboard-container"+t,document.querySelector("#ui-dashboard-root").appendChild(listeningContainerDiv)})),t.article.forEach((e=>{const t=`<div class="col-lg-3 card-group-row__col">\n                                        <div class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay card-group-row__card" data-toggle="popover" data-trigger="click" data-original-title="" title="" data-domfactory-upgraded="overlay">\n                                            <a href="/lesson/${e.id}" class="card-img-top js-image load" data-position="center" data-height="140" data-domfactory-upgraded="image" style="display: block; position: relative; overflow: hidden; background-image: url(&quot;http://localhost/public/images/paths/flinto_430x168.png&quot;); background-size: cover; background-position: center center; height: 140px;">\n                                                <img src="/public/images/paths/flinto_430x168.png" alt="course" style="visibility: hidden;">\n                                                <span class="overlay__content">\n                                                    <span class="overlay__action d-flex flex-column text-center">\n                                                        <i class="material-icons icon-32pt">play_circle_outline</i>\n                                                        <span class="card-title text-white">Resume</span>\n                                                    </span>\n                                                </span>\n                                            </a>\n\n                                            <div class="card-body flex">\n                                                <div class="d-flex">\n                                                    <div class="flex">\n                                                        <a class="load card-title" href="/lesson/${e.id}">${e.name}</a>\n                                                        <small class="text-50 font-weight-bold mb-4pt">Elijah Murray</small>\n                                                    </div>\n                                                    <a href="javascript:void(0)" class="ml-4pt material-icons text-20 card-course__icon-favorite" onclick="addToFavourite(this, '${e.id}')">favorite_border</a>\n                                                </div>\n                                            </div>\n                                            <div class="card-footer">\n                                                <div class="row justify-content-between">\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">access_time</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>6 hours</small></p>\n                                                    </div>\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">play_circle_outline</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>12 lessons</small></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>`;document.querySelector("#ui-dashboard-container"+e.section_id).insertAdjacentHTML("beforeend",t)}))}if(t.reading.length>0){const e=t.reading.reduce(((e,t)=>(e[t.section_id]||(e[t.section_id]=[]),e[t.section_id].push(t),e)),{});Object.keys(e).forEach((t=>{const n=e[t][0].section_name,o=document.createElement("div");o.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent=n,o.appendChild(i),document.querySelector("#ui-dashboard-root").appendChild(o),readingContainerDiv=document.createElement("div"),readingContainerDiv.className="row card-group-row",readingContainerDiv.id="ui-dashboard-container"+t,document.querySelector("#ui-dashboard-root").appendChild(readingContainerDiv)})),t.reading.forEach((e=>{const t=`<div class="col-lg-3 card-group-row__col">\n                                        <div class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay card-group-row__card" data-toggle="popover" data-trigger="click" data-original-title="" title="" data-domfactory-upgraded="overlay">\n                                            <a href="/lesson/${e.id}" class="card-img-top js-image load" data-position="center" data-height="140" data-domfactory-upgraded="image" style="display: block; position: relative; overflow: hidden; background-image: url(&quot;http://localhost/public/images/paths/flinto_430x168.png&quot;); background-size: cover; background-position: center center; height: 140px;">\n                                                <img src="/public/images/paths/flinto_430x168.png" alt="course" style="visibility: hidden;">\n                                                <span class="overlay__content">\n                                                    <span class="overlay__action d-flex flex-column text-center">\n                                                        <i class="material-icons icon-32pt">play_circle_outline</i>\n                                                        <span class="card-title text-white">Resume</span>\n                                                    </span>\n                                                </span>\n                                            </a>\n\n                                            <div class="card-body flex">\n                                                <div class="d-flex">\n                                                    <div class="flex">\n                                                        <a class="load card-title" href="/lesson/${e.id}">${e.name}</a>\n                                                        <small class="text-50 font-weight-bold mb-4pt">Elijah Murray</small>\n                                                    </div>\n                                                    <a href="javascript:void(0)" class="ml-4pt material-icons text-20 card-course__icon-favorite" onclick="addToFavourite(this, '${e.id}')">favorite_border</a>\n                                                </div>\n                                            </div>\n                                            <div class="card-footer">\n                                                <div class="row justify-content-between">\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">access_time</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>6 hours</small></p>\n                                                    </div>\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">play_circle_outline</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>12 lessons</small></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>`;document.querySelector("#ui-dashboard-container"+e.section_id).insertAdjacentHTML("beforeend",t)}))}if(t.flashcard.length>0){const e=t.flashcard.reduce(((e,t)=>(e[t.section_id]||(e[t.section_id]=[]),e[t.section_id].push(t),e)),{});Object.keys(e).forEach((t=>{const n=e[t][0].section_name,o=document.createElement("div");o.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent=n,o.appendChild(i),document.querySelector("#ui-dashboard-root").appendChild(o),readingContainerDiv=document.createElement("div"),readingContainerDiv.className="row card-group-row",readingContainerDiv.id="ui-dashboard-container"+t,document.querySelector("#ui-dashboard-root").appendChild(readingContainerDiv)})),t.flashcard.forEach((e=>{const t=`<div class="col-lg-3 card-group-row__col">\n                                        <div class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay card-group-row__card" data-toggle="popover" data-trigger="click" data-original-title="" title="" data-domfactory-upgraded="overlay">\n                                            <a href="/lesson/${e.id}" class="card-img-top js-image load" data-position="center" data-height="140" data-domfactory-upgraded="image" style="display: block; position: relative; overflow: hidden; background-image: url(&quot;http://localhost/public/images/paths/flinto_430x168.png&quot;); background-size: cover; background-position: center center; height: 140px;">\n                                                <img src="/public/images/paths/flinto_430x168.png" alt="course" style="visibility: hidden;">\n                                                <span class="overlay__content">\n                                                    <span class="overlay__action d-flex flex-column text-center">\n                                                        <i class="material-icons icon-32pt">play_circle_outline</i>\n                                                        <span class="card-title text-white">Resume</span>\n                                                    </span>\n                                                </span>\n                                            </a>\n\n                                            <div class="card-body flex">\n                                                <div class="d-flex">\n                                                    <div class="flex">\n                                                        <a class="load card-title" href="/lesson/${e.id}">${e.name}</a>\n                                                        <small class="text-50 font-weight-bold mb-4pt">Elijah Murray</small>\n                                                    </div>\n                                                    <a href="javascript:void(0)" class="ml-4pt material-icons text-20 card-course__icon-favorite" onclick="addToFavourite(this, '${e.id}')">favorite_border</a>\n                                                </div>\n                                            </div>\n                                            <div class="card-footer">\n                                                <div class="row justify-content-between">\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">access_time</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>6 hours</small></p>\n                                                    </div>\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">play_circle_outline</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>12 lessons</small></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>`;document.querySelector("#ui-dashboard-container"+e.section_id).insertAdjacentHTML("beforeend",t)}))}NProgress.done(),await switchPages(),document.getElementById("ui-drawer-mycourses-item").classList.add("open"),document.getElementById("ui-navbar-my_courses-toggler").classList.remove("collapsed"),document.querySelector("#my_courses").classList.add("show"),document.getElementById("ui-navbar-my_courses-toggler").setAttribute("aria-expanded","true");const n=document.getElementById("ui-navbar-mycourse-item-"+e);n&&n.classList.add("active")}else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Trình duyệt không hỗ trợ Fetch API."})}}function loadHomePage(){NProgress.start(),checkLoginStatus().then((()=>{fetch(apiSubdomain+"blog/list",{method:"POST"}).then((e=>{e.ok&&e.json().then((e=>{const t=document.getElementById("ui-home-blogs");t&&(t.innerHTML=""),e.data.forEach((e=>{const n=document.importNode(document.getElementById("ui-blog-item").content,!0);n.querySelector('[data-id="blog-image"').src=e.cover_image,n.querySelector('[data-id="blog-name"').textContent=e.name,n.querySelector('[data-id="blog-name"').href="/blog/"+e.id,t.appendChild(n)})),setTimeout((()=>{const e=document.querySelector(".js-mdk-carousel");if(e){const t=e.mdkCarousel;t&&"function"==typeof t.init?t.init():t&&"function"==typeof t._reset&&t._reset()}else console.error("Carousel DOM element not found.");setTimeout((()=>{document.getElementById("ui-home-blogs").style.transform="translate3d(0px, 0px, 0px)"}),50)}),100),switchPages(),document.title="EngBoost - Học Tiếng Anh cá nhân hóa & luyện thi chứng chỉ",document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("home").forEach((e=>e.style.display="block")),NProgress.done(),document.getElementById("ui-drawer-home-item").classList.add("active"),document.getElementById("ui-login-submit").disabled=!1,document.getElementById("ui-login-submit").classList.remove("is-loading")}))}))}))}async function checkLoginStatus(){try{const e=await fetch(apiSubdomain+"auth/auth",{method:"POST"});if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();if("Authorized"===t.message){(window.location.href.includes("login")||window.location.href.includes("register"))&&(window.history.pushState({},"","/"),loadHomePage()),document.querySelector("#ui-navbar-logged-in").style.display="flex",document.querySelector("#ui-navbar-not-logged-in").style.display="none",csrf_token=t.csrf_token,document.querySelector("#ui-navbar-totalBonus").textContent=t.totalBonus+" điểm",document.getElementById("ui-navbar-avatar").src=t.avatar,document.getElementById("ui-navbar-my_courses-toggler").classList.remove("disabled"),document.getElementById("ui-navbar-useravatar").src="https://cdn.jsdelivr.net/gh/ducanhdang34/storage@main/images/teacher_white.svg",document.querySelector("#ui-navbar-fullname").textContent=t.fullname,await fetch(apiSubdomain+"course/list",{method:"POST"}).then((e=>{e.ok&&(document.getElementById("my_courses").innerHTML="",document.getElementById("ui-navbar-manage-lessons-menu").innerHTML="",e.json().then((e=>{e.forEach((e=>{const t=`<li class="sidebar-menu-item" id="ui-navbar-mycourse-item-${e.id}"><a class="sidebar-menu-button load" href="/dashboard/${e.id}" title="${e.name}"><span class="sidebar-menu-text" style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;width: 100%;">${e.name}</span></a></li>`,n=`<li class="sidebar-menu-item" id="ui-navbar-mycourse-item-${e.id}"><a class="sidebar-menu-button load" href="/quizzes/${e.id}" title="${e.name}"><span class="sidebar-menu-text" style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;width: 100%;">${e.name}</span></a></li>`;document.querySelector("#my_courses").insertAdjacentHTML("beforeend",t),document.getElementById("ui-navbar-manage-lessons-menu").insertAdjacentHTML("beforeend",n)}))})))}));const e=new FormData;e.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"messages/messages",{method:"POST",body:e});if(n.ok){const e=await n.json();document.querySelector("#ui-navbar-messagesListContainer").innerHTML="",[e.messages].forEach((e=>{const t=document.importNode(document.querySelector("#ui-navbar-message-item").content,!0);null==e.content&&(t.querySelector('[data-id="user-message"]').textContent="Chưa có tin nhắn nào",t.querySelector('[data-id="user-timestamp"]').textContent="Chưa từng trò chuyện",t.querySelector('[data-id="unread-indicator"]').style.display="none"),t.querySelector('[data-id="user-fullname"]').textContent=e.fullname,t.querySelector('[data-id="user-avatar"]').src=e.avatar,t.querySelector('[data-id="user-id"]').setAttribute("onclick","openChatConversation('"+e.id+"')"),document.querySelector("#ui-navbar-messagesListContainer").appendChild(t)}))}return!0}return document.querySelector("#ui-navbar-logged-in").style.display="none",document.querySelector("#ui-navbar-not-logged-in").style.display="flex",document.getElementById("ui-navbar-my_courses-toggler").classList.add("disabled"),document.querySelector("#ui-navbar-fullname").textContent="Chưa Đăng Nhập",document.querySelector("#ui-navbar-useravatar").src="https://cdn.jsdelivr.net/gh/ducanhdang34/storage@main/images/white.svg",(window.location.href.includes("account")||window.location.href.includes("/news/manage/"))&&loadLoginPage(),!1}catch(e){console.error(e)}}async function openChatConversation(e){const t=new FormData;t.append("receiver_id",e),t.append("csrf_token",csrf_token);if((await fetch(apiSubdomain+"messages/conversation",{method:"POST",body:t})).ok)document.querySelector("#conversation-drawer").setAttribute("data-opened",!0),document.querySelector("body").style.overflow="hidden";else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}}async function performCreateNewFlashcard(e,t){e.preventDefault(),NProgress.start(),await checkLoginStatus();const n=new FormData;n.append("csrf_token",csrf_token),n.append("courseId",t);const o=await fetch(apiSubdomain+"edit/flashcard/initialize",{body:n,method:"POST"}),i=await o.json();if(!o.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}if("success"!==i.message){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Đã khởi tạo bài tập mới thành công"}),NProgress.done(),await loadEditFlashcardPage(i.flashcardId)}async function performCreateNewReadingLesson(e,t){e.preventDefault(),NProgress.start(),await checkLoginStatus();const n=new FormData;n.append("csrf_token",csrf_token),n.append("courseId",t);const o=await fetch(apiSubdomain+"edit/reading/initialize",{method:"POST",body:n}),i=await o.json();if(o.ok)if("success"===i.message){window.history.pushState({},"","/edit/"+i.lessonId),document.title="Bài tập chưa có tên",document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("edit-reading").forEach((e=>e.style.display="block"));Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Đã khởi tạo bài tập mới thành công"})}else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Không thể khởi tạo bài tập mới"})}else{Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Không thể khởi tạo bài tập mới"})}NProgress.done(),await loadEditReadingPage(i.lessonId)}async function loadManageLessonsPage(e){NProgress.start(),await checkLoginStatus(),document.getElementById("ui-manage-lessons-createListeningButton").setAttribute("onclick","performCreateNewListeningLesson(event, '"+e+"')"),document.getElementById("ui-manage-lessons-createReadingButton").setAttribute("onclick","performCreateNewReadingLesson(event, '"+e+"')"),document.getElementById("ui-manage-lessons-createFlashcardButton").setAttribute("onclick","performCreateNewFlashcard(event, '"+e+"')");const t=new FormData;t.append("id",e),t.append("manage",!0),t.append("csrf_token",csrf_token);const n=await fetch(apiSubdomain+"dashboard/dashboard",{method:"POST",body:t});if(!n.ok){return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Lỗi hệ thống, vui lòng thử lại sau"})}const o=await n.json();if(document.title=o.informations.name,document.querySelector("#ui-manage-lessons-root").replaceChildren(),o.listening.length>0){const e=o.listening.reduce(((e,t)=>(e[t.section_id]||(e[t.section_id]=[]),e[t.section_id].push(t),e)),{});Object.keys(e).forEach((t=>{const n=e[t][0].section_name,o=document.createElement("div");o.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent=n,o.appendChild(i),document.querySelector("#ui-manage-lessons-root").appendChild(o),listeningContainerDiv=document.createElement("div"),listeningContainerDiv.className="row card-group-row",listeningContainerDiv.id="ui-manage-lessons-container"+t,document.querySelector("#ui-manage-lessons-root").appendChild(listeningContainerDiv)})),o.listening.forEach((e=>{const t=`<div class="col-lg-3 card-group-row__col">\n                                        <div class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay card-group-row__card" data-toggle="popover" data-trigger="click" data-original-title="" title="" data-domfactory-upgraded="overlay">\n                                            <a href="/lesson/${e.id}" class="card-img-top js-image load" data-position="center" data-height="140" data-domfactory-upgraded="image" style="display: block; position: relative; overflow: hidden; background-image: url(&quot;http://localhost/public/images/paths/flinto_430x168.png&quot;); background-size: cover; background-position: center center; height: 140px;">\n                                                <img src="/public/images/paths/flinto_430x168.png" alt="course" style="visibility: hidden;">\n                                                <span class="overlay__content">\n                                                    <span class="overlay__action d-flex flex-column text-center">\n                                                        <i class="material-icons icon-32pt">play_circle_outline</i>\n                                                        <span class="card-title text-white">Resume</span>\n                                                    </span>\n                                                </span>\n                                            </a>\n\n                                            <div class="card-body flex">\n                                                <div class="d-flex">\n                                                    <div class="flex">\n                                                        <a class="load card-title" href="/lesson/${e.id}">${e.name}</a>\n                                                        <small class="text-50 font-weight-bold mb-4pt">Elijah Murray</small>\n                                                    </div>\n                                                    <a href="javascript:void(0)" class="ml-4pt material-icons text-20 card-course__icon-favorite" onclick="addToFavourite(this, '${e.id}')">favorite_border</a>\n                                                </div>\n                                            </div>\n                                            <div class="card-footer">\n                                                <div class="row justify-content-between">\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">access_time</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>6 hours</small></p>\n                                                    </div>\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">play_circle_outline</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>12 lessons</small></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>`;document.querySelector("#ui-manage-lessons-container"+e.section_id).insertAdjacentHTML("beforeend",t)}))}if(o.article.length>0){const e=o.article.reduce(((e,t)=>(e[t.section_id]||(e[t.section_id]=[]),e[t.section_id].push(t),e)),{});Object.keys(e).forEach((t=>{const n=e[t][0].section_name,o=document.createElement("div");o.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent=n,o.appendChild(i),document.querySelector("#ui-manage-lessons-root").appendChild(o),listeningContainerDiv=document.createElement("div"),listeningContainerDiv.className="row card-group-row",listeningContainerDiv.id="ui-manage-lessons-container"+t,document.querySelector("#ui-manage-lessons-root").appendChild(listeningContainerDiv)})),o.article.forEach((e=>{const t=`<div class="col-lg-3 card-group-row__col">\n                                        <div class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay card-group-row__card" data-toggle="popover" data-trigger="click" data-original-title="" title="" data-domfactory-upgraded="overlay">\n                                            <a href="/lesson/${e.id}" class="card-img-top js-image load" data-position="center" data-height="140" data-domfactory-upgraded="image" style="display: block; position: relative; overflow: hidden; background-image: url(&quot;http://localhost/public/images/paths/flinto_430x168.png&quot;); background-size: cover; background-position: center center; height: 140px;">\n                                                <img src="/public/images/paths/flinto_430x168.png" alt="course" style="visibility: hidden;">\n                                                <span class="overlay__content">\n                                                    <span class="overlay__action d-flex flex-column text-center">\n                                                        <i class="material-icons icon-32pt">play_circle_outline</i>\n                                                        <span class="card-title text-white">Resume</span>\n                                                    </span>\n                                                </span>\n                                            </a>\n\n                                            <div class="card-body flex">\n                                                <div class="d-flex">\n                                                    <div class="flex">\n                                                        <a class="load card-title" href="/lesson/${e.id}">${e.name}</a>\n                                                        <small class="text-50 font-weight-bold mb-4pt">Elijah Murray</small>\n                                                    </div>\n                                                    <a href="javascript:void(0)" class="ml-4pt material-icons text-20 card-course__icon-favorite" onclick="addToFavourite(this, '${e.id}')">favorite_border</a>\n                                                </div>\n                                            </div>\n                                            <div class="card-footer">\n                                                <div class="row justify-content-between">\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">access_time</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>6 hours</small></p>\n                                                    </div>\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">play_circle_outline</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>12 lessons</small></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>`;document.querySelector("#ui-manage-lessons-container"+e.section_id).insertAdjacentHTML("beforeend",t)}))}if(o.reading.length>0){const e=o.reading.reduce(((e,t)=>(e[t.section_id]||(e[t.section_id]=[]),e[t.section_id].push(t),e)),{});Object.keys(e).forEach((t=>{const n=e[t][0].section_name,o=document.createElement("div");o.className="page-separator";const i=document.createElement("div");i.className="page-separator__text",i.textContent=n,o.appendChild(i),document.querySelector("#ui-manage-lessons-root").appendChild(o),readingContainerDiv=document.createElement("div"),readingContainerDiv.className="row card-group-row",readingContainerDiv.id="ui-manage-lessons-container"+t,document.querySelector("#ui-manage-lessons-root").appendChild(readingContainerDiv)})),o.reading.forEach((e=>{const t=`<div class="col-lg-3 card-group-row__col">\n                                        <div class="card card-sm card--elevated p-relative o-hidden overlay overlay--primary-dodger-blue js-overlay card-group-row__card" data-toggle="popover" data-trigger="click" data-original-title="" title="" data-domfactory-upgraded="overlay">\n                                            <a href="/lesson/${e.id}" class="card-img-top js-image load" data-position="center" data-height="140" data-domfactory-upgraded="image" style="display: block; position: relative; overflow: hidden; background-image: url(&quot;http://localhost/public/images/paths/flinto_430x168.png&quot;); background-size: cover; background-position: center center; height: 140px;">\n                                                <img src="/public/images/paths/flinto_430x168.png" alt="course" style="visibility: hidden;">\n                                                <span class="overlay__content">\n                                                    <span class="overlay__action d-flex flex-column text-center">\n                                                        <i class="material-icons icon-32pt">play_circle_outline</i>\n                                                        <span class="card-title text-white">Resume</span>\n                                                    </span>\n                                                </span>\n                                            </a>\n\n                                            <div class="card-body flex">\n                                                <div class="d-flex">\n                                                    <div class="flex">\n                                                        <a class="load card-title" href="/lesson/${e.id}">${e.name}</a>\n                                                        <small class="text-50 font-weight-bold mb-4pt">Elijah Murray</small>\n                                                    </div>\n                                                    <a href="javascript:void(0)" class="ml-4pt material-icons text-20 card-course__icon-favorite" onclick="addToFavourite(this, '${e.id}')">favorite_border</a>\n                                                </div>\n                                            </div>\n                                            <div class="card-footer">\n                                                <div class="row justify-content-between">\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">access_time</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>6 hours</small></p>\n                                                    </div>\n                                                    <div class="col-auto d-flex align-items-center">\n                                                        <span class="material-icons icon-16pt text-50 mr-4pt">play_circle_outline</span>\n                                                        <p class="flex text-50 lh-1 mb-0"><small>12 lessons</small></p>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>`;document.querySelector("#ui-manage-lessons-container"+e.section_id).insertAdjacentHTML("beforeend",t)}))}switchPages(),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("manage-quizzes").forEach((e=>e.style.display="block")),NProgress.done(),document.getElementById("ui-drawer-manageLessons-item").classList.add("open"),document.getElementById("ui-navbar-manage-lessons-toggler").classList.remove("collapsed"),document.querySelector("#ui-navbar-manage-lessons-menu").classList.add("show"),document.getElementById("ui-navbar-manage-lessons-toggler").setAttribute("aria-expanded","true")}async function switchPages(){return new Promise((e=>{clearInterval(timer);let t=document.querySelector(".ui-lesson-details-timer");t.style.transition="none",t.style.width="100%",window.scrollTo(0,0);const n=document.querySelector(".preloader");let o=1;!function t(){o-=.05,o<=0?(n.style.display="none",n.style.opacity=1,e()):(n.style.opacity=o,requestAnimationFrame(t))}(),document.getElementById("ui-drawer-home-item").classList.remove("active"),document.querySelector("#ui-login-username").value="",document.querySelector("#ui-login-username").classList.remove("is-invalid"),document.querySelector("#ui-login-invalid-username").style.display="none",document.getElementById("ui-login-password").value="",document.getElementById("ui-login-password").classList.remove("is-invalid"),document.querySelector("#ui-login-invalid-password").style.display="none",window.location.href.includes("/dashboard/")||(document.getElementById("ui-drawer-mycourses-item").classList.remove("open"),document.getElementById("ui-navbar-my_courses-toggler").classList.add("collapsed"),document.querySelector("#my_courses").classList.remove("show"),document.getElementById("ui-navbar-my_courses-toggler").setAttribute("aria-expanded","false"));try{Audioplayer.destroy()}catch(e){}}))}function loadLoginPage(){NProgress.start(),showLoginScreenWhenRecaptchaReady("6LfsmHMrAAAAABqKOdIt1mVQpBNmxRVwdYmPvRXR")}async function loadRegisterPage(){NProgress.start(),document.title="Đăng ký",await checkLoginStatus(),switchPages(),document.querySelectorAll("#root > *:not(.doNotHide)").forEach((e=>e.style.display="none")),document.querySelectorAll("register").forEach((e=>e.style.display="block")),NProgress.done()}document.getElementById("ui-lesson-details-flashcardCarousel-inner").addEventListener("click",(function(e){const t=e.target.closest("[data-audio]");if(!t||!this.contains(t))return;let n=t.getAttribute("data-audio");n+=(n.includes("?")?"&":"?")+"v="+Date.now();new Audio(n).play().catch((e=>{console.warn("Audio playback failed:",e)}))})),document.getElementById("ui-login-form").addEventListener("submit",(async function(e){e.preventDefault(),document.getElementById("ui-login-submit").disabled=!0,document.getElementById("ui-login-submit").classList.add("is-loading"),await grecaptcha.ready((function(){grecaptcha.execute("6LfsmHMrAAAAABqKOdIt1mVQpBNmxRVwdYmPvRXR",{action:"submit_form"}).then((function(e){const t=new FormData;t.append("username",document.getElementById("ui-login-username").value),t.append("password",document.getElementById("ui-login-password").value),t.append("g-recaptcha-response",e),fetch(apiSubdomain+"auth/login",{method:"POST",body:t}).then((e=>{e.ok&&e.json().then((async e=>{if("failed"===e.message)document.querySelector("#ui-login-invalid-username").textContent="Sai thông tin đăng nhập",document.querySelector("#ui-login-invalid-username").style.display="block",document.querySelector("#ui-login-username").classList.add("is-invalid"),document.querySelector("#ui-login-username").classList.remove("is-valid"),document.querySelector("#ui-login-invalid-password").textContent="Sai thông tin đăng nhập",document.querySelector("#ui-login-invalid-password").style.display="block",document.querySelector("#ui-login-password").classList.add("is-invalid"),document.querySelector("#ui-login-password").classList.remove("is-valid"),document.getElementById("ui-login-submit").disabled=!1,document.getElementById("ui-login-submit").classList.remove("is-loading");else{await NProgress.start(),loadHomePage(),window.history.pushState({},"","/");Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Đăng nhập thành công"})}}))}))}))}))})),document.getElementById("ui-register-form").addEventListener("submit",(function(e){if(e.preventDefault(),document.querySelector("#terms").classList.remove("is-invalid"),!document.querySelector("#terms").checked){document.querySelector("#terms").classList.add("is-invalid");return void Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"error",title:"Bạn chưa đồng ý các điều khoản"})}document.getElementById("ui-register-submit").disabled=!0;const t=new FormData;t.append("fullname",document.getElementById("ui-register-fullname").value),t.append("username",document.getElementById("ui-register-username").value),t.append("email",document.getElementById("ui-register-email").value),t.append("phone",document.getElementById("ui-register-phone").value),t.append("password",document.getElementById("ui-register-password").value),t.append("password_confirm",document.getElementById("ui-register-confirm-password").value),fetch(apiSubdomain+"auth/register",{method:"POST",body:t}).then((e=>{e.ok&&e.json().then((e=>{if(document.getElementById("ui-register-submit").disabled=!1,"success"===e.message){loadLoginPage(),window.history.pushState({},"","/login");Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}}).fire({icon:"success",title:"Đăng ký thành công"})}else""!==e.fullname_err?(document.getElementById("ui-register-fullname").classList.add("is-invalid"),document.getElementById("ui-register-fullname-invalid").textContent=e.fullname_err,document.getElementById("ui-register-fullname-invalid").style.display="block"):(document.getElementById("ui-register-fullname-invalid").style.display="none",document.getElementById("ui-register-fullname").classList.add("is-valid"),document.getElementById("ui-register-fullname").classList.remove("is-invalid")),""!==e.username_err?(document.getElementById("ui-register-username").classList.add("is-invalid"),document.getElementById("ui-register-username-invalid").textContent=e.username_err,document.getElementById("ui-register-username-invalid").style.display="block"):(document.getElementById("ui-register-username-invalid").style.display="none",document.getElementById("ui-register-username").classList.add("is-valid"),document.getElementById("ui-register-username").classList.remove("is-invalid")),""!==e.email_err?(document.getElementById("ui-register-email").classList.add("is-invalid"),document.getElementById("ui-register-email-invalid").textContent=e.email_err,document.getElementById("ui-register-email-invalid").style.display="block"):(document.getElementById("ui-register-email-invalid").style.display="none",document.getElementById("ui-register-email").classList.add("is-valid"),document.getElementById("ui-register-email").classList.remove("is-invalid")),""!==e.phone_err?(document.getElementById("ui-register-phone").classList.add("is-invalid"),document.getElementById("ui-register-phone-invalid").textContent=e.phone_err,document.getElementById("ui-register-phone-invalid").style.display="block"):(document.getElementById("ui-register-phone-invalid").style.display="none",document.getElementById("ui-register-phone").classList.add("is-valid"),document.getElementById("ui-register-phone").classList.remove("is-invalid")),""!==e.password_err?(document.getElementById("ui-register-password").classList.add("is-invalid"),document.getElementById("ui-register-password-invalid").textContent=e.password_err,document.getElementById("ui-register-password-invalid").style.display="block"):(document.getElementById("ui-register-password-invalid").style.display="none",document.getElementById("ui-register-password").classList.add("is-valid"),document.getElementById("ui-register-password").classList.remove("is-invalid")),""!==e.confirm_err?(document.getElementById("ui-register-confirm-password").classList.add("is-invalid"),document.getElementById("ui-register-confirm-invalid").textContent=e.confirm_err,document.getElementById("ui-register-confirm-invalid").style.display="block"):(document.getElementById("ui-register-confirm-invalid").style.display="none",document.getElementById("ui-register-confirm-password").classList.add("is-valid"),document.getElementById("ui-register-confirm-password").classList.remove("is-invalid"))}))}))})),function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=214)}([function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n(57))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var o=n(0),i=n(29),a=n(3),r=n(27),s=n(31),l=n(52),c=i("wks"),d=o.Symbol,u=l?d:d&&d.withoutSetter||r;e.exports=function(e){return a(c,e)||(s&&a(d,e)?c[e]=d[e]:c[e]=u("Symbol."+e)),c[e]}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var o=n(1);e.exports=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){var o=n(4);e.exports=function(e){if(!o(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){var o=n(5),i=n(37),a=n(6),r=n(17),s=Object.defineProperty;t.f=o?s:function(e,t,n){if(a(e),t=r(t,!0),a(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var o=n(0),i=n(23).f,a=n(9),r=n(12),s=n(21),l=n(49),c=n(47);e.exports=function(e,t){var n,d,u,m,p,h=e.target,g=e.global,f=e.stat;if(n=g?o:f?o[h]||s(h,{}):(o[h]||{}).prototype)for(d in t){if(m=t[d],u=e.noTargetGet?(p=i(n,d))&&p.value:n[d],!c(g?d:h+(f?".":"#")+d,e.forced)&&void 0!==u){if(typeof m==typeof u)continue;l(m,u)}(e.sham||u&&u.sham)&&a(m,"sham",!0),r(n,d,m,e)}}},function(e,t,n){var o=n(5),i=n(7),a=n(14);e.exports=o?function(e,t,n){return i.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var o=n(33),i=n(13);e.exports=function(e){return o(i(e))}},function(e,t,n){var o=n(19),i=Math.min;e.exports=function(e){return e>0?i(o(e),9007199254740991):0}},function(e,t,n){var o=n(0),i=n(9),a=n(3),r=n(21),s=n(35),l=n(24),c=l.get,d=l.enforce,u=String(String).split("String");(e.exports=function(e,t,n,s){var l,c=!!s&&!!s.unsafe,m=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||a(n,"name")||i(n,"name",t),(l=d(n)).source||(l.source=u.join("string"==typeof t?t:""))),e!==o?(c?!p&&e[t]&&(m=!0):delete e[t],m?e[t]=n:i(e,t,n)):m?e[t]=n:r(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var o=n(13);e.exports=function(e){return Object(o(e))}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var o=n(4);e.exports=function(e,t){if(!o(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!o(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!o(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!o(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports={}},function(e,t){var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},function(e,t,n){var o=n(50),i=n(0),a=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?a(o[e])||a(i[e]):o[e]&&o[e][t]||i[e]&&i[e][t]}},function(e,t,n){var o=n(0),i=n(9);e.exports=function(e,t){try{i(o,e,t)}catch(n){o[e]=t}return t}},function(e,t,n){var o=n(0),i=n(21),a=o["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=a},function(e,t,n){var o=n(5),i=n(43),a=n(14),r=n(10),s=n(17),l=n(3),c=n(37),d=Object.getOwnPropertyDescriptor;t.f=o?d:function(e,t){if(e=r(e),t=s(t,!0),c)try{return d(e,t)}catch(e){}if(l(e,t))return a(!i.f.call(e,t),e[t])}},function(e,t,n){var o,i,a,r=n(64),s=n(0),l=n(4),c=n(9),d=n(3),u=n(22),m=n(25),p=n(18),h=s.WeakMap;if(r){var g=u.state||(u.state=new h),f=g.get,y=g.has,w=g.set;o=function(e,t){return t.facade=e,w.call(g,e,t),t},i=function(e){return f.call(g,e)||{}},a=function(e){return y.call(g,e)}}else{var v=m("state");p[v]=!0,o=function(e,t){return t.facade=e,c(e,v,t),t},i=function(e){return d(e,v)?e[v]:{}},a=function(e){return d(e,v)}}e.exports={set:o,get:i,has:a,enforce:function(e){return a(e)?i(e):o(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var o=n(29),i=n(27),a=o("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}},function(e,t){e.exports=!1},function(e,t){var n=0,o=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+o).toString(36)}},function(e,t,n){var o=n(5),i=n(1),a=n(3),r=Object.defineProperty,s={},l=function(e){throw e};e.exports=function(e,t){if(a(s,e))return s[e];t||(t={});var n=[][e],c=!!a(t,"ACCESSORS")&&t.ACCESSORS,d=a(t,0)?t[0]:l,u=a(t,1)?t[1]:void 0;return s[e]=!!n&&!i((function(){if(c&&!o)return!0;var e={length:-1};c?r(e,1,{enumerable:!0,get:l}):e[1]=1,n.call(e,d,u)}))}},function(e,t,n){var o=n(26),i=n(22);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.0",mode:o?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,n){var o=n(1);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){return!String(Symbol())}))},function(e,t,n){var o=n(16);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,t,n){var o=n(1),i=n(16),a="".split;e.exports=o((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?a.call(e,""):Object(e)}:Object},function(e,t,n){var o=n(40),i=n(30).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return o(e,i)}},function(e,t,n){var o=n(22),i=Function.toString;"function"!=typeof o.inspectSource&&(o.inspectSource=function(e){return i.call(e)}),e.exports=o.inspectSource},,function(e,t,n){var o=n(5),i=n(1),a=n(39);e.exports=!o&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var o=n(19),i=Math.max,a=Math.min;e.exports=function(e,t){var n=o(e);return n<0?i(n+t,0):a(n,t)}},function(e,t,n){var o=n(0),i=n(4),a=o.document,r=i(a)&&i(a.createElement);e.exports=function(e){return r?a.createElement(e):{}}},function(e,t,n){var o=n(3),i=n(10),a=n(55).indexOf,r=n(18);e.exports=function(e,t){var n,s=i(e),l=0,c=[];for(n in s)!o(r,n)&&o(s,n)&&c.push(n);for(;t.length>l;)o(s,n=t[l++])&&(~a(c,n)||c.push(n));return c}},function(e,t,n){var o,i=n(6),a=n(85),r=n(30),s=n(18),l=n(82),c=n(39),d=n(25)("IE_PROTO"),u=function(){},m=function(e){return"<script>"+e+"<\/script>"},p=function(){try{o=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;p=o?function(e){e.write(m("")),e.close();var t=e.parentWindow.Object;return e=null,t}(o):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(m("document.F=Object")),e.close(),e.F);for(var n=r.length;n--;)delete p.prototype[r[n]];return p()};s[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(u.prototype=i(e),n=new u,u.prototype=null,n[d]=e):n=p(),void 0===t?n:a(n,t)}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){"use strict";var o={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,a=i&&!o.call({1:2},1);t.f=a?function(e){var t=i(this,e);return!!t&&t.enumerable}:o},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var o=n(53),i=n(33),a=n(15),r=n(11),s=n(60),l=[].push,c=function(e){var t=1==e,n=2==e,c=3==e,d=4==e,u=6==e,m=7==e,p=5==e||u;return function(h,g,f,y){for(var w,v,S=a(h),b=i(S),C=o(g,f,3),x=r(b.length),B=0,q=y||s,E=t?q(h,x):n||m?q(h,0):void 0;x>B;B++)if((p||B in b)&&(v=C(w=b[B],B,S),e))if(t)E[B]=v;else if(v)switch(e){case 3:return!0;case 5:return w;case 6:return B;case 2:l.call(E,w)}else switch(e){case 4:return!1;case 7:l.call(E,w)}return u?-1:c||d?d:E}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},function(e,t,n){"use strict";var o=n(8),i=n(1),a=n(32),r=n(4),s=n(15),l=n(11),c=n(51),d=n(60),u=n(48),m=n(2),p=n(61),h=m("isConcatSpreadable"),g=p>=51||!i((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),f=u("concat"),y=function(e){if(!r(e))return!1;var t=e[h];return void 0!==t?!!t:a(e)};o({target:"Array",proto:!0,forced:!g||!f},{concat:function(e){var t,n,o,i,a,r=s(this),u=d(r,0),m=0;for(t=-1,o=arguments.length;t<o;t++)if(y(a=-1===t?r:arguments[t])){if(m+(i=l(a.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,m++)n in a&&c(u,m,a[n])}else{if(m>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(u,m++,a)}return u.length=m,u}})},function(e,t,n){var o=n(1),i=/#|\.prototype\./,a=function(e,t){var n=s[r(e)];return n==c||n!=l&&("function"==typeof t?o(t):!!t)},r=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},function(e,t,n){var o=n(1),i=n(2),a=n(61),r=i("species");e.exports=function(e){return a>=51||!o((function(){var t=[];return(t.constructor={})[r]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){var o=n(3),i=n(65),a=n(23),r=n(7);e.exports=function(e,t){for(var n=i(t),s=r.f,l=a.f,c=0;c<n.length;c++){var d=n[c];o(e,d)||s(e,d,l(t,d))}}},function(e,t,n){var o=n(0);e.exports=o},function(e,t,n){"use strict";var o=n(17),i=n(7),a=n(14);e.exports=function(e,t,n){var r=o(t);r in e?i.f(e,r,a(0,n)):e[r]=n}},function(e,t,n){var o=n(31);e.exports=o&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var o=n(62);e.exports=function(e,t,n){if(o(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,i){return e.call(t,n,o,i)}}return function(){return e.apply(t,arguments)}}},,function(e,t,n){var o=n(10),i=n(11),a=n(38),r=function(e){return function(t,n,r){var s,l=o(t),c=i(l.length),d=a(r,c);if(e&&n!=n){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}};e.exports={includes:r(!0),indexOf:r(!1)}},function(e,t,n){var o=n(40),i=n(30);e.exports=Object.keys||function(e){return o(e,i)}},function(e,t,n){var o,i=n(42);o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":i(window))&&(o=window)}e.exports=o},,function(e,t,n){"use strict";var o=n(8),i=n(4),a=n(32),r=n(38),s=n(11),l=n(10),c=n(51),d=n(2),u=n(48),m=n(28),p=u("slice"),h=m("slice",{ACCESSORS:!0,0:0,1:2}),g=d("species"),f=[].slice,y=Math.max;o({target:"Array",proto:!0,forced:!p||!h},{slice:function(e,t){var n,o,d,u=l(this),m=s(u.length),p=r(e,m),h=r(void 0===t?m:t,m);if(a(u)&&("function"!=typeof(n=u.constructor)||n!==Array&&!a(n.prototype)?i(n)&&null===(n=n[g])&&(n=void 0):n=void 0,n===Array||void 0===n))return f.call(u,p,h);for(o=new(void 0===n?Array:n)(y(h-p,0)),d=0;p<h;p++,d++)p in u&&c(o,d,u[p]);return o.length=d,o}})},function(e,t,n){var o=n(4),i=n(32),a=n(2)("species");e.exports=function(e,t){var n;return i(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!i(n.prototype)?o(n)&&null===(n=n[a])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){var o,i,a=n(0),r=n(74),s=a.process,l=s&&s.versions,c=l&&l.v8;c?i=(o=c.split("."))[0]+o[1]:r&&(!(o=r.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=r.match(/Chrome\/(\d+)/))&&(i=o[1]),e.exports=i&&+i},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},,function(e,t,n){var o=n(0),i=n(35),a=o.WeakMap;e.exports="function"==typeof a&&/native code/.test(i(a))},function(e,t,n){var o=n(20),i=n(34),a=n(44),r=n(6);e.exports=o("Reflect","ownKeys")||function(e){var t=i.f(r(e)),n=a.f;return n?t.concat(n(e)):t}},,,,,function(e,t,n){var o=n(2),i=n(41),a=n(7),r=o("unscopables"),s=Array.prototype;null==s[r]&&a.f(s,r,{configurable:!0,value:i(null)}),e.exports=function(e){s[r][e]=!0}},,function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},,function(e,t,n){var o=n(20);e.exports=o("navigator","userAgent")||""},,,function(e,t,n){"use strict";var o=n(1);e.exports=function(e,t){var n=[][e];return!!n&&o((function(){n.call(null,t||function(){throw 1},1)}))}},,,,,function(e,t,n){var o=n(20);e.exports=o("document","documentElement")},,,function(e,t,n){var o=n(5),i=n(7),a=n(6),r=n(56);e.exports=o?Object.defineProperties:function(e,t){a(e);for(var n,o=r(t),s=o.length,l=0;s>l;)i.f(e,n=o[l++],t[n]);return e}},,,,function(e,t,n){"use strict";var o=n(8),i=n(91);o({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},,function(e,t,n){"use strict";var o=n(45).forEach,i=n(77),a=n(28),r=i("forEach"),s=a("forEach");e.exports=r&&s?[].forEach:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}},,function(e,t,n){var o=n(0),i=n(72),a=n(91),r=n(9);for(var s in i){var l=o[s],c=l&&l.prototype;if(c&&c.forEach!==a)try{r(c,"forEach",a)}catch(e){c.forEach=a}}},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var o=n(8),i=n(45).find,a=n(70),r=n(28),s=!0,l=r("find");"find"in[]&&Array(1).find((function(){s=!1})),o({target:"Array",proto:!0,forced:s||!l},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("find")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){domFactory.handler.register("accordion",(function(){return{_onShow:function(e){$(e.target).hasClass("accordion__menu")&&$(e.target).closest(".accordion__item").addClass("open")},_onHide:function(e){$(e.target).hasClass("accordion__menu")&&$(e.target).closest(".accordion__item").removeClass("open")},init:function(){$(this.element).on("show.bs.collapse",this._onShow),$(this.element).on("hide.bs.collapse",this._onHide)},destroy:function(){$(this.element).off("show.bs.collapse",this._onShow),$(this.element).off("hide.bs.collapse",this._onHide)}}}))},,,,,,,,function(e,t){!function(){"use strict";domFactory.handler.autoInit(),$('[data-toggle="tooltip"]').tooltip()}()},function(e,t){!function(){"use strict";$("[data-perfect-scrollbar]").each((function(){var e=$(this),t=new PerfectScrollbar(this,{wheelPropagation:void 0!==e.data("perfect-scrollbar-wheel-propagation")&&e.data("perfect-scrollbar-wheel-propagation"),suppressScrollY:void 0!==e.data("perfect-scrollbar-suppress-scroll-y")&&e.data("perfect-scrollbar-suppress-scroll-y"),swipeEasing:!1});Object.defineProperty(this,"PerfectScrollbar",{configurable:!0,writable:!1,value:t})}))}()},function(e,t,n){n(113),n(89),n(59),n(93),n(113),n(89),n(59),n(93),function(){"use strict";var e=document.querySelectorAll('[data-toggle="sidebar"]');(e=Array.prototype.slice.call(e)).forEach((function(e){e.addEventListener("click",(function(e){var t=e.currentTarget.getAttribute("data-target")||"#default-drawer",n=document.querySelector(t);n&&n.mdkDrawer.toggle()}))}));var t=document.querySelectorAll(".mdk-drawer");(t=Array.prototype.slice.call(t)).forEach((function(e){e.addEventListener("mdk-drawer-change",(function(e){if(e.target.mdkDrawer){document.querySelector("body").classList[e.target.mdkDrawer.opened?"add":"remove"]("has-drawer-opened");var t=document.querySelector('[data-target="#'+e.target.id+'"]');t&&t.classList[e.target.mdkDrawer.opened?"add":"remove"]("active")}}))})),$(".sidebar .collapse").on("show.bs.collapse",(function(e){e.stopPropagation(),$(this).parent().closest("ul").find(".open").find(".collapse").not(this).collapse("hide"),$(this).closest("li").addClass("open")})),$(".sidebar .collapse").on("hidden.bs.collapse",(function(e){e.stopPropagation(),$(this).closest("li").removeClass("open")}))}()},function(e,t){!function(){"use strict";$('.dropdown[data-toggle="tooltip"]').on("shown.bs.dropdown",(function(e){$(e.target).tooltip("hide").tooltip("disable")})).on("hide.bs.dropdown",(function(e){$(e.target).tooltip("enable")}))}()},function(e,t,n){n(46),n(46),function(){"use strict";$("body").on("shown.bs.popover",(function(e){$(e.target).data("bs.popover")._activeTrigger.click=!0})),$("body").on("hidden.bs.popover",(function(e){$(e.target).data("bs.popover")._activeTrigger.click=!1}));var e="body";e=document.querySelector(".mdk-drawer-layout__content")?".mdk-drawer-layout__content":e,e=document.querySelector(".mdk-header-layout__content")?".mdk-header-layout__content":e;var t={trigger:"click",html:!0,container:e=document.querySelector(".mdk-drawer-layout__content .mdk-drawer-layout__content")?".mdk-drawer-layout__content .mdk-drawer-layout__content":e,content:function(){return $(this).next(".popoverContainer").html()},template:'<div class="popover popover-lg" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'};function n(){this.mdkReveal&&this.mdkReveal.close(),this.overlay&&this.overlay.hide()}var o=".".concat("bs.popover"),i={CLICK:"click".concat(o),CLICK_DATA_API:"click".concat(o).concat(".data-api"),KEYUP_DATA_API:"keyup".concat(o).concat(".data-api")};$(document).on("".concat(i.CLICK_DATA_API," ").concat(i.KEYUP_DATA_API),(function(e){e&&(3===e.which||"keyup"===e.type&&9!==e.which)||$('[data-toggle="popover"][data-trigger="click"]').popover("hide").each(n)})),$('[data-toggle="popover"][data-trigger="click"]').popover(t).click((function(e){e.preventDefault(),e.stopPropagation(),$('[data-toggle="popover"]').not(this).popover("hide").each(n)})),$('[data-toggle="popover"][data-trigger="hover"]').popover(t).on("mouseenter",(function(){var e=this;$(this).popover("show"),$(".popover").on("mouseleave",(function(){$(e).popover("hide")}))})).on("mouseleave",(function(){var e=this;setTimeout((function(){$(".popover:hover").length||$(e).popover("hide")}),300)}));var a=$('[data-toggle="popover"][data-popover-onload-show]');a.popover("show"),window.addEventListener("load",(function(){a.popover("update")}))}()},function(e,t){domFactory.handler.register("overlay",(function(){return{properties:{overlayOnloadShow:{type:Boolean,reflectToAttribute:!0},trigger:{value:"hover",reflectToAttribute:!0}},observers:["_onChange(shown)"],listeners:["_onEnter(mouseenter, touchstart)","_onLeave(mouseleave, touchend)","_onClick(click)"],show:function(){this.shown=!0},hide:function(){this.shown=!1},toggle:function(){this.shown=!this.shown},_onChange:function(){if(this.shown)return this.element.classList.add("overlay--show");this.element.classList.remove("overlay--show")},_onEnter:function(){"hover"===this.trigger&&this.show()},_onLeave:function(){"hover"===this.trigger&&this.hide()},_onClick:function(){"click"===this.trigger&&this.toggle()},init:function(){"ontouchstart"in window&&this.element.classList.add("overlay--duserselect")},_reset:function(){this.overlayOnloadShow&&!this.shown&&this.show()}}}))},function(e,t){domFactory.handler.register("mdk-carousel-control",(function(){return{properties:{slide:{reflectToAttribute:!0,value:"next"}},listeners:["_onClick(click)"],_onClick:function(e){e.preventDefault();var t=document.querySelector(this.element.getAttribute("href"));t&&t.mdkCarousel[this.slide]()}}}))},function(e,t,n){"use strict";n.r(t),n.d(t,"imageComponent",(function(){return o}));var o=function(){return{properties:{position:{reflectToAttribute:!0,value:"center"},height:{reflectToAttribute:!0,value:"auto"}},get image(){return this.element.querySelector("img")},_reset:function(){this.image&&(this.element.style.display="block",this.element.style.position="relative",this.element.style.overflow="hidden",this.element.style.backgroundImage="url(".concat(this.image.src,")"),this.element.style.backgroundSize="cover",this.element.style.backgroundPosition=this.position,this.element.style.height="".concat("auto"===this.height?this.image.offsetHeight:this.height,"px"),this.image.style.visibility="hidden")}}};domFactory.handler.register("image",o)},function(e,t,n){"use strict";n.r(t),n.d(t,"playerComponent",(function(){return o}));var o=function(){return{listeners:["button.onClick(click)"],get button(){return this.element.querySelector(".player__content")},play:function(){this.element.querySelector(".player__embed").classList.remove("d-none"),this.element.querySelector(".player__embed iframe").src+="&autoplay=1"},onClick:function(e){e.preventDefault(),this.play()}}};domFactory.handler.register("player",o)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(215)},function(e,t,n){"use strict";n.r(t),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(159),n(175),$('[data-toggle="tab"]').on("hide.bs.tab",(function(e){$(e.target).removeClass("active")}))}]);